"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[690],{1911:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"apache-hadoop/hive/Examples/hive-4.0.0-docer-01","title":"Hive-4.0.0 Docker 01","description":"Prerequisites","source":"@site/docs/apache-hadoop/hive/Examples/hive-4.0.0-docer-01.mdx","sourceDirName":"apache-hadoop/hive/Examples","slug":"/apache-hadoop/hive/Examples/hive-4.0.0-docer-01","permalink":"/docs/apache-hadoop/hive/Examples/hive-4.0.0-docer-01","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"Hive","permalink":"/docs/apache-hadoop/hive/"},"next":{"title":"Hive-4.* Docker Loading Data","permalink":"/docs/apache-hadoop/hive/Examples/hive-4.*-loading-data"}}');var r=i(4848),t=i(8453);const o={sidebar_position:10},c="Hive-4.0.0 Docker 01",a={},d=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Launch Hive",id:"launch-hive",level:2},{value:"docker-compose.yml",id:"docker-composeyml",level:4},{value:"docker compose up -d",id:"docker-compose-up--d",level:4},{value:"Beeline:",id:"beeline",level:2},{value:"Run some queries:",id:"run-some-queries",level:2},{value:"HiveServer2",id:"hiveserver2",level:2},{value:"Postgres Metastore",id:"postgres-metastore",level:2},{value:"Output:",id:"output",level:4},{value:"Hive Hadoop",id:"hive-hadoop",level:2},{value:"Output:",id:"output-1",level:4},{value:"Output:",id:"output-2",level:4}];function h(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"hive-400-docker-01",children:"Hive-4.0.0 Docker 01"})}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Docker"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"launch-hive",children:"Launch Hive"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"export HIVE_VERSION=4.0.0\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"export POSTGRES_LOCAL_PATH=your_local_path_to_postgres_driver\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.h4,{id:"docker-composeyml",children:"docker-compose.yml"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nversion: '3.9'\nservices:\n  postgres:\n    image: postgres\n    restart: unless-stopped\n    container_name: postgres\n    hostname: postgres\n    environment:\n      POSTGRES_DB: 'metastore_db'\n      POSTGRES_USER: 'hive'\n      POSTGRES_PASSWORD: 'password'\n    ports:\n      - '5432:5432'\n    volumes:\n      - hive-db:/var/lib/postgresql\n    networks:\n      - hive\n\n  metastore:\n    image: apache/hive:${HIVE_VERSION}\n    depends_on:\n      - postgres\n    restart: unless-stopped\n    container_name: metastore\n    hostname: metastore\n    environment:\n      DB_DRIVER: postgres\n      SERVICE_NAME: 'metastore'\n      SERVICE_OPTS: '-Xmx1G -Djavax.jdo.option.ConnectionDriverName=org.postgresql.Driver\n                     -Djavax.jdo.option.ConnectionURL=jdbc:postgresql://postgres:5432/metastore_db\n                     -Djavax.jdo.option.ConnectionUserName=hive\n                     -Djavax.jdo.option.ConnectionPassword=password'\n    ports:\n        - '9083:9083'\n    volumes:\n        - warehouse:/opt/hive/data/warehouse\n        - type: bind\n          source: ${POSTGRES_LOCAL_PATH}\n          target: /opt/hive/lib/postgres.jar\n    networks:\n      - hive\n\n  hiveserver2:\n    image: apache/hive:${HIVE_VERSION}\n    depends_on:\n      - metastore\n    restart: unless-stopped\n    container_name: hiveserver2\n    environment:\n      HIVE_SERVER2_THRIFT_PORT: 10000\n      SERVICE_OPTS: '-Xmx1G -Dhive.metastore.uris=thrift://metastore:9083'\n      IS_RESUME: 'true'\n      SERVICE_NAME: 'hiveserver2'\n    ports:\n      - '10000:10000'\n      - '10002:10002'\n    volumes:\n      - warehouse:/opt/hive/data/warehouse\n    networks:\n      - hive\n\nvolumes:\n  hive-db:\n  warehouse:\n\nnetworks:\n  hive:\n    name: hive\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.h4,{id:"docker-compose-up--d",children:"docker compose up -d"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"docker ps -a\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'CONTAINER ID   IMAGE               COMMAND                  CREATED          STATUS          PORTS                                                          NAMES\n088e0373719e   apache/hive:4.0.0   "sh -c /entrypoint.sh"   20 minutes ago   Up 3 minutes    0.0.0.0:10000->10000/tcp, 9083/tcp, 0.0.0.0:10002->10002/tcp   hiveserver2\n0cf91a83e260   apache/hive:4.0.0   "sh -c /entrypoint.sh"   20 minutes ago   Up 3 minutes    10000/tcp, 0.0.0.0:9083->9083/tcp, 10002/tcp                   metastore\nbeff35c5e819   postgres            "docker-entrypoint.s\u2026"   20 minutes ago   Up 20 minutes   0.0.0.0:5432->5432/tcp                                         postgres\n'})}),"\n",(0,r.jsx)(n.h2,{id:"beeline",children:"Beeline:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"docker exec -it hiveserver2 beeline -u 'jdbc:hive2://hiveserver2:10000/'"})})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:" docker exec -it hiveserver2 beeline -u 'jdbc:hive2://hiveserver2:10000/'\n # If beeline is installed on host machine, HiveServer2 can be simply reached via:\n # beeline -u 'jdbc:hive2://localhost:10000/'\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"...\nConnecting to jdbc:hive2://hiveserver2:10000/\nConnected to: Apache Hive (version 4.0.0)\nDriver: Hive JDBC (version 4.0.0)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\nBeeline version 4.0.0 by Apache Hive\n0: jdbc:hive2://hiveserver2:10000/>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"show databases;"})})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"0: jdbc:hive2://hiveserver2:10000/> show databases;\nINFO  : Compiling command(queryId=hive_20250430080937_22a191f2-e4c7-485c-b964-19e0628cc576): show databases\nINFO  : Semantic Analysis Completed (retrial = false)\nINFO  : Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:database_name, type:string, comment:from deserializer)], properties:null)\nINFO  : Completed compiling command(queryId=hive_20250430080937_22a191f2-e4c7-485c-b964-19e0628cc576); Time taken: 0.824 seconds\nINFO  : Concurrency mode is disabled, not creating a lock manager\nINFO  : Executing command(queryId=hive_20250430080937_22a191f2-e4c7-485c-b964-19e0628cc576): show databases\nINFO  : Starting task [Stage-0:DDL] in serial mode\nINFO  : Completed executing command(queryId=hive_20250430080937_22a191f2-e4c7-485c-b964-19e0628cc576); Time taken: 0.05 seconds\n+----------------+\n| database_name  |\n+----------------+\n| default        |\n+----------------+\n1 row selected (1.32 seconds)\n0: jdbc:hive2://hiveserver2:10000/>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"run-some-queries",children:"Run some queries:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"  create table hive_example(a string, b int) partitioned by(c int);\n  alter table hive_example add partition(c=1);\n  insert into hive_example partition(c=1) values('a', 1), ('a', 2),('b',3);\n  select count(distinct a) from hive_example;\n  select sum(b) from hive_example;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"0: jdbc:hive2://hiveserver2:10000/> show tables;\nINFO  : Compiling command(queryId=hive_20250429090109_b00b0c5a-d603-436c-bda5-52b48c397c85): show tables\nINFO  : Semantic Analysis Completed (retrial = false)\nINFO  : Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:tab_name, type:string, comment:from deserializer)], properties:null)\nINFO  : Completed compiling command(queryId=hive_20250429090109_b00b0c5a-d603-436c-bda5-52b48c397c85); Time taken: 0.011 seconds\nINFO  : Concurrency mode is disabled, not creating a lock manager\nINFO  : Executing command(queryId=hive_20250429090109_b00b0c5a-d603-436c-bda5-52b48c397c85): show tables\nINFO  : Starting task [Stage-0:DDL] in serial mode\nINFO  : Completed executing command(queryId=hive_20250429090109_b00b0c5a-d603-436c-bda5-52b48c397c85); Time taken: 0.033 seconds\n+---------------+\n|   tab_name    |\n+---------------+\n| hive_example  |\n+---------------+\n1 row selected (0.092 seconds)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"hiveserver2",children:"HiveServer2"}),"\n",(0,r.jsxs)(n.p,{children:["Accessed on browser at ",(0,r.jsx)(n.code,{children:"http://localhost:10002/"})]}),"\n",(0,r.jsx)("img",{src:"/img/apache-hadoop/hive/03-hive-brows31-01.png",alt:"03-hive-brows31-01.png"}),"\n",(0,r.jsx)(n.h2,{id:"postgres-metastore",children:"Postgres Metastore"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"docker exec -it postgres psql -h localhost -U hive -d metastore_db\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'psql (17.4 (Debian 17.4-1.pgdg120+2))\nType "help" for help.\n\nmetastore_db=#\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"metastore_db-# \\l\n                                                  List of databases\n     Name     | Owner | Encoding | Locale Provider |  Collate   |   Ctype    | Locale | ICU Rules | Access privileges\n--------------+-------+----------+-----------------+------------+------------+--------+-----------+-------------------\n metastore_db | hive  | UTF8     | libc            | en_US.utf8 | en_US.utf8 |        |           |\n postgres     | hive  | UTF8     | libc            | en_US.utf8 | en_US.utf8 |        |           |\n template0    | hive  | UTF8     | libc            | en_US.utf8 | en_US.utf8 |        |           | =c/hive          +\n              |       |          |                 |            |            |        |           | hive=CTc/hive\n template1    | hive  | UTF8     | libc            | en_US.utf8 | en_US.utf8 |        |           | =c/hive          +\n              |       |          |                 |            |            |        |           | hive=CTc/hive\n(4 rows)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"metastore_db=# \\c metastore_db;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"metastore_db=# \\dt\n"})}),"\n",(0,r.jsx)(n.h4,{id:"output",children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"                   List of relations\n Schema |             Name              | Type  | Owner\n--------+-------------------------------+-------+-------\n public | AUX_TABLE                     | table | hive\n public | BUCKETING_COLS                | table | hive\n public | CDS                           | table | hive\n public | COLUMNS_V2                    | table | hive\n public | COMPACTION_METRICS_CACHE      | table | hive\n public | COMPACTION_QUEUE              | table | hive\n public | COMPLETED_COMPACTIONS         | table | hive\n public | COMPLETED_TXN_COMPONENTS      | table | hive\n public | CTLGS                         | table | hive\n public | DATABASE_PARAMS               | table | hive\n public | DATACONNECTORS                | table | hive\n public | DATACONNECTOR_PARAMS          | table | hive\n public | DBS                           | table | hive\n public | DB_PRIVS                      | table | hive\n public | DC_PRIVS                      | table | hive\n public | DELEGATION_TOKENS             | table | hive\n public | FUNCS                         | table | hive\n public | FUNC_RU                       | table | hive\n public | GLOBAL_PRIVS                  | table | hive\n public | HIVE_LOCKS                    | table | hive\n:\n"})}),"\n",(0,r.jsx)(n.h2,{id:"hive-hadoop",children:"Hive Hadoop"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"docker exec -it hiveserver2 bash\n"})}),"\n",(0,r.jsx)(n.h4,{id:"output-1",children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"hive@4d687e8196e1:/opt/hive$\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"hive@4d687e8196e1:/opt/hive$ cd ..\n"})}),"\n",(0,r.jsx)(n.h4,{id:"output-2",children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"hive@4d687e8196e1:/opt$\nhadoop\thive  tez\n"})})]})}function l(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);