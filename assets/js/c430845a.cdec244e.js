"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[7785],{4365:(e,n,s)=>{s.d(n,{W:()=>l});var a=s(6540),t=s(502);const r=["zero","one","two","few","many","other"];function o(e){return r.filter((n=>e.includes(n)))}const i={locale:"en",pluralForms:o(["one","other"]),select:e=>1===e?"one":"other"};function c(){const{i18n:{currentLocale:e}}=(0,t.A)();return(0,a.useMemo)((()=>{try{return function(e){const n=new Intl.PluralRules(e);return{locale:e,pluralForms:o(n.resolvedOptions().pluralCategories),select:e=>n.select(e)}}(e)}catch(n){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${n.message}\n`),i}}),[e])}function l(){const e=c();return{selectMessage:(n,s)=>function(e,n,s){const a=e.split("|");if(1===a.length)return a[0];a.length>s.pluralForms.length&&console.error(`For locale=${s.locale}, a maximum of ${s.pluralForms.length} plural forms are expected (${s.pluralForms.join(",")}), but the message contains ${a.length}: ${e}`);const t=s.select(n),r=s.pluralForms.indexOf(t);return a[Math.min(r,a.length-1)]}(s,n,e)}}},5172:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"aws/sns/examples/spring-boot-sns-lambda","title":"Spring Boot SNS Lambda","description":"Description","source":"@site/docs/aws/sns/examples/spring-boot-sns-lambda.mdx","sourceDirName":"aws/sns/examples","slug":"/aws/sns/examples/spring-boot-sns-lambda","permalink":"/docs/aws/sns/examples/spring-boot-sns-lambda","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20},"sidebar":"tutorialSidebar","previous":{"title":"Spring Boot Message to SNS","permalink":"/docs/aws/sns/examples/spring-boot-message-to-sns"},"next":{"title":"References","permalink":"/docs/aws/sns/references"}}');var t=s(4848),r=s(8453),o=s(7170),i=s(3304);const c={sidebar_position:20},l="Spring Boot SNS Lambda",d={},m=[{value:"Description",id:"description",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Run LocalStack",id:"run-localstack",level:2},{value:"Create Topic",id:"create-topic",level:3},{value:"Create a Subscription",id:"create-a-subscription",level:3},{value:"Project Structure",id:"project-structure",level:2},{value:"Source Code: <em><strong>https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda</strong></em>",id:"source-code-httpsgithubcomzbciokzjc-examplestreemainawsawssnsspring-boot-sns-lambda",level:4},{value:"Project Structure:",id:"project-structure-1",level:4},{value:"Lambda Function",id:"lambda-function",level:3},{value:"SNSEvent",id:"snsevent",level:3},{value:"Run Lambda Function",id:"run-lambda-function",level:3},{value:"Spring Boot",id:"spring-boot",level:3},{value:"Output (Docker Log):",id:"output-docker-log",level:3},{value:"Notice:",id:"notice",level:4}];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"spring-boot-sns-lambda",children:"Spring Boot SNS Lambda"})}),"\n",(0,t.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"In this example we will publish messages to an SNS topic, and Lambda from a Spring Boot application."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"JDK 21"}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://maven.apache.org/install.html",children:"Maven 3.8.5+"})}),"\n",(0,t.jsx)(n.li,{children:"Spring Boot, version 3+"}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://localstack.cloud/",children:"LocalStack"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:"Docker"})," - for running LocalStack"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://aws.amazon.com/cli/",children:"AWS CLI"})," and ",(0,t.jsx)(n.a,{href:"https://docs.localstack.cloud/user-guide/integrations/aws-cli/#localstack-aws-cli-awslocal",children:"awslocal"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"run-localstack",children:"Run LocalStack"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'version: \'3.8\'\n\nservices:\n  localstack:\n    image: localstack/localstack\n    container_name: localstack_main\n    ports:\n      - "4566-4599:4566-4599"\n    environment:\n      - SERVICES=sns,s3,sqs,dynamodb,ses,lambda,logs,stepfunctions\n      - DYNAMODB_SHARE_DB=1\n      - DEBUG=1\n      - DATA_DIR=/tmp/localstack/data\n      - DOCKER_HOST=unix:///var/run/docker.sock\n    volumes:\n      - "${LOCALSTACK_VOLUME_DIR:-./volume}:/var/lib/localstack"\n      - "/var/run/docker.sock:/var/run/docker.sock"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"create-topic",children:"Create Topic"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"awslocal sns create-topic --name localstack-topic --region us-east-1\n"})}),"\n",(0,t.jsx)(n.h3,{id:"create-a-subscription",children:"Create a Subscription"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"awslocal sns subscribe \\\n--region us-east-1 \\\n--protocol lambda \\\n--topic-arn arn:aws:sns:us-east-1:000000000000:localstack-topic \\\n--notification-endpoint arn:aws:lambda:us-east-1:000000000000:function:localstack-lambda-sns\n"})}),"\n",(0,t.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.h4,{id:"source-code-httpsgithubcomzbciokzjc-examplestreemainawsawssnsspring-boot-sns-lambda",children:["Source Code: ",(0,t.jsx)(n.em,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda",children:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda"})})})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.h4,{id:"project-structure-1",children:"Project Structure:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:".\n\u251c\u2500\u2500 sns-lambda\n\u2502\xa0\xa0 \u251c\u2500\u2500 pom.xml\n\u2502\xa0\xa0 \u251c\u2500\u2500 src\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 main\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 java\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 com\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 example\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0         \u251c\u2500\u2500 Main.java\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0         \u2514\u2500\u2500 SnsRequestHandler.java\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 resources\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 test\n\u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 java\n\u2502\xa0\xa0 \u2514\u2500\u2500 target\n\u2502\xa0\xa0     \u251c\u2500\u2500 classes\n\u2502\xa0\xa0     \u251c\u2500\u2500 original-sns-trigger-lambda-0.0.1.jar\n\u2502\xa0\xa0     \u251c\u2500\u2500 sns-trigger-lambda-0.0.1.jar\n\u2502\xa0\xa0     \u2514\u2500\u2500 test-classes\n|\n\u2514\u2500\u2500 spring-boot-sns-lambda\n    \u251c\u2500\u2500 mvnw\n    \u251c\u2500\u2500 mvnw.cmd\n    \u251c\u2500\u2500 pom.xml\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 src\n    \u2502\xa0\xa0 \u251c\u2500\u2500 main\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 java\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 com\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 jreact\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0         \u2514\u2500\u2500 sns\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u251c\u2500\u2500 PersonRequest.java\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u251c\u2500\u2500 SNSAppConfig.java\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u2514\u2500\u2500 SNSApp.java\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 resources\n    \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 application.properties\n    \u2502\xa0\xa0 \u2514\u2500\u2500 test\n    \u2502\xa0\xa0     \u2514\u2500\u2500 java\n    \u2514\u2500\u2500 target\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.h3,{id:"lambda-function",children:"Lambda Function"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda/sns-lambda",children:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda/sns-lambda"})})})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'package com.example;\n\nimport com.amazonaws.services.lambda.runtime.Context;\nimport com.amazonaws.services.lambda.runtime.LambdaLogger;\nimport com.amazonaws.services.lambda.runtime.RequestHandler;\nimport com.amazonaws.services.lambda.runtime.events.SNSEvent;\n\nimport java.util.List;\nimport com.amazonaws.services.lambda.runtime.events.SNSEvent.SNSRecord;\nimport lombok.extern.java.Log;\n\nimport java.util.Iterator;\n\n@Log\npublic class SnsRequestHandler implements RequestHandler<SNSEvent, Boolean> {\n    LambdaLogger logger;\n    private SNSEvent event;\n\n    @Override\n    public Boolean handleRequest(SNSEvent event, Context context) {\n        log.info(">>> start handleRequest...");\n        logger = context.getLogger();\n        List<SNSRecord> records = event.getRecords();\n\n        if (!records.isEmpty()) {\n            Iterator<SNSRecord> recordsIter = records.iterator();\n            while (recordsIter.hasNext()) {\n                processRecord(recordsIter.next());\n            }\n        }\n        return Boolean.TRUE;\n    }\n\n    public void processRecord(SNSRecord record) {\n        try {\n            String message = record.getSNS().getMessage();\n            logger.log(">>> message: " + message);\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.h3,{id:"snsevent",children:"SNSEvent"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://javadoc.io/doc/com.amazonaws/aws-lambda-java-events/3.7.0/com/amazonaws/services/lambda/runtime/events/SNSEvent.html",children:"https://javadoc.io/doc/com.amazonaws/aws-lambda-java-events/3.7.0/com/amazonaws/services/lambda/runtime/events/SNSEvent.html"})})})})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.h3,{id:"run-lambda-function",children:"Run Lambda Function"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"awslocal lambda create-function \\\n    --region us-east-1 \\\n    --function-name localstack-lambda-sns \\\n    --runtime java21 \\\n    --zip-file fileb://sns-trigger-lambda-0.0.1.jar \\\n    --handler com.example.SnsRequestHandler \\\n    --role arn:aws:iam::000000000000:role/example-lambda-noop-role \\\n    --timeout 120\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.h3,{id:"spring-boot",children:"Spring Boot"}),"\n",(0,t.jsx)(n.em,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda/spring-boot-sns-lambda",children:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/sns/spring-boot-sns-lambda/spring-boot-sns-lambda"})})})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mvn clean install\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mvn spring-boot:run\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.h3,{id:"output-docker-log",children:"Output (Docker Log):"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'\n...\nlocalstack_main  | 2024-10-07T15:06:10.577 DEBUG --- [ns:$LATEST_1] l.s.l.i.version_manager    : [localstack-lambda-sns-9977d26f-34e3-4fd8-b718-488404fe7eb3] INFO: >>> start handleRequest...\nlocalstack_main  | 2024-10-07T15:06:10.577 DEBUG --- [ns:$LATEST_1] l.s.l.i.version_manager    : [localstack-lambda-sns-9977d26f-34e3-4fd8-b718-488404fe7eb3] >>> message: {"id":0,"firstName":"Jack","lastName":"Smith","age":30,"address":"Address02"}END RequestId: 9977d26f-34e3-4fd8-b718-488404fe7eb3\n...\nlocalstack_main  | 2024-10-07T15:06:10.602 DEBUG --- [ns:$LATEST_0] l.s.l.i.version_manager    : [localstack-lambda-sns-d762704c-0d15-4dee-9b45-543fb9193d6e] INFO: >>> start handleRequest...\nlocalstack_main  | 2024-10-07T15:06:10.602 DEBUG --- [ns:$LATEST_0] l.s.l.i.version_manager    : [localstack-lambda-sns-d762704c-0d15-4dee-9b45-543fb9193d6e] >>> message: {"id":0,"firstName":"John","lastName":"Doe","age":26,"address":"Address01"}END RequestId: d762704c-0d15-4dee-9b45-543fb9193d6e\n...\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.h4,{id:"notice",children:"Notice:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'{"id":0,"firstName":"Jack","lastName":"Smith","age":30,"address":"Address02"}\n{"id":0,"firstName":"John","lastName":"Doe","age":26,"address":"Address01"}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)("br",{}),"\n","\n",(0,t.jsx)(o.A,{items:(0,i.$S)().items})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},7170:(e,n,s)=>{s.d(n,{A:()=>g});s(6540);var a=s(4164),t=s(7936),r=s(7634),o=s(4365),i=s(5242),c=s(9979),l=s(4861);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var m=s(4848);function u(e){let{href:n,children:s}=e;return(0,m.jsx)(r.A,{href:n,className:(0,a.A)("card padding--lg",d.cardContainer),children:s})}function h(e){let{href:n,icon:s,title:t,description:r}=e;return(0,m.jsxs)(u,{href:n,children:[(0,m.jsxs)(l.A,{as:"h2",className:(0,a.A)("text--truncate",d.cardTitle),title:t,children:[s," ",t]}),r&&(0,m.jsx)("p",{className:(0,a.A)("text--truncate",d.cardDescription),title:r,children:r})]})}function p(e){let{item:n}=e;const s=(0,t.Nr)(n),a=function(){const{selectMessage:e}=(0,o.W)();return n=>e(n,(0,c.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:n}))}();return s?(0,m.jsx)(h,{href:s,icon:"\ud83d\uddc3\ufe0f",title:n.label,description:n.description??a(n.items.length)}):null}function x(e){let{item:n}=e;const s=(0,i.A)(n.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",a=(0,t.cC)(n.docId??void 0);return(0,m.jsx)(h,{href:n.href,icon:s,title:n.label,description:n.description??a?.description})}function b(e){let{item:n}=e;switch(n.type){case"link":return(0,m.jsx)(x,{item:n});case"category":return(0,m.jsx)(p,{item:n});default:throw new Error(`unknown item type ${JSON.stringify(n)}`)}}function j(e){let{className:n}=e;const s=(0,t.$S)();return(0,m.jsx)(g,{items:s.items,className:n})}function g(e){const{items:n,className:s}=e;if(!n)return(0,m.jsx)(j,{...e});const r=(0,t.d1)(n);return(0,m.jsx)("section",{className:(0,a.A)("row",s),children:r.map(((e,n)=>(0,m.jsx)("article",{className:"col col--6 margin-bottom--lg",children:(0,m.jsx)(b,{item:e})},n)))})}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>i});var a=s(6540);const t={},r=a.createContext(t);function o(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);