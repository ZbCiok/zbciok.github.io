"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[1744],{3106:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=s(4848),t=s(8453);const r={sidebar_position:40},o="Session Window",l={id:"streams/apache-flink/Examples/session-window",title:"Session Window",description:"Description",source:"@site/docs/streams/apache-flink/Examples/session-window.mdx",sourceDirName:"streams/apache-flink/Examples",slug:"/streams/apache-flink/Examples/session-window",permalink:"/docs/streams/apache-flink/Examples/session-window",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:40,frontMatter:{sidebar_position:40},sidebar:"tutorialSidebar",previous:{title:"Postgres to FlinkTable",permalink:"/docs/streams/apache-flink/Examples/postgres-flink-table"},next:{title:"Sliding Window",permalink:"/docs/streams/apache-flink/Examples/sliding-window"}},a={},c=[{value:"Description",id:"description",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"SessionWindow.java",id:"sessionwindowjava",level:3},{value:"Run &amp; Output",id:"run--output",level:2},{value:"Output",id:"output",level:3},{value:"Source Code: <br></br> <em><strong>https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/session-window</strong></em>",id:"source-code--httpsgithubcomzbciokzjc-examplestreemainstreamsflinksession-window",level:4}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"session-window",children:"Session Window"})}),"\n",(0,i.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"/docs/streams/apache-flink/Operators/windowing#session-window",children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Session Window"})})})}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JDK 11"}),"\n",(0,i.jsx)(n.li,{children:"Maven"}),"\n",(0,i.jsx)(n.li,{children:"IDE (IntelliJ IDEA, Eclipse)"}),"\n",(0,i.jsx)(n.li,{children:"Flink 1.20.0"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:".\n\u251c\u2500\u2500 dependency-reduced-pom.xml\n\u251c\u2500\u2500 pom.xml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main\n        \u251c\u2500\u2500 java\n        \u2502\xa0\xa0 \u2514\u2500\u2500 com\n        \u2502\xa0\xa0     \u2514\u2500\u2500 jreact\n        \u2502\xa0\xa0         \u2514\u2500\u2500 flink\n        \u2502\xa0\xa0             \u2514\u2500\u2500 sessionwindow\n        \u2502\xa0\xa0                 \u2514\u2500\u2500 SessionWindow.java\n        \u2514\u2500\u2500 resources\n            \u251c\u2500\u2500 log4j\n            \u2514\u2500\u2500 log4j.properties.txt\n"})}),"\n",(0,i.jsx)(n.h3,{id:"sessionwindowjava",children:"SessionWindow.java"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class SessionWindow {\n\n    public static void main(String[] args) throws Exception {\n\n        StreamExecutionEnvironment executionEnvironment =\n                StreamExecutionEnvironment.getExecutionEnvironment();\n\n        DataStream<String> text = executionEnvironment\n                .socketTextStream("localhost", 9000, \'\\n\', 6);\n\n        DataStream<Tuple3<String,String, Double>> userClickStream = text.map(row -> {\n            String[] fields = row.split(",");\n            if (fields.length == 3) {\n                return new Tuple3<>(\n                        fields[0],\n                        fields[1],\n                        Double.parseDouble(fields[2])\n                );\n            }\n            throw new Exception("Not valid arg passed");\n        }, TypeInformation.of(new TypeHint<Tuple3<String, String, Double>>() {\n        }));\n\n        DataStream<Tuple3<String, String, Double>> maxPageVisitTime =\n                userClickStream.keyBy(((KeySelector<Tuple3<String, String, Double>,\n                                        Tuple2<String, String>>) stringStringDoubleTuple3 ->\n                                        new Tuple2<>(stringStringDoubleTuple3.f0, stringStringDoubleTuple3.f1)),\n                                TypeInformation.of(new TypeHint<Tuple2<String, String>>() {\n                                }))\n                        .window(ProcessingTimeSessionWindows.withGap(Time.seconds(10)))\n                        .max(2);\n\n        maxPageVisitTime.print();\n\n        executionEnvironment.execute("Session window example.");\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"run--output",children:"Run & Output"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"mvn clean package"})}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"\nCopy ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"target/sessionwindow-0.1.jar"})})," to ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"flink-1.20.0/examples/jreact"})}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"\nStart local cluster:",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"./bin/start-cluster.sh"})}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"\nOpen the terminal and run below command to start a socket window: ",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"nc -lk 9000"})}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"\nOpen a new terminal and run:",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"./bin/flink run examples/jreact/sessionwindow-0.1.jar"})}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"\nInsert some data:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"// on the nc -lk 9000:\naaa,bbb,1\nbbb,ccc,2\nccc,ddd,3\n"})}),"\n",(0,i.jsx)(n.h3,{id:"output",children:"Output"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"flink-1.20.0/log/flink-*-taskexecutor-*.out:\n\n(aaa,bbb,1.0)\n(bbb,ccc,2.0)\n(ccc,ddd,3.0)\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"source-code--httpsgithubcomzbciokzjc-examplestreemainstreamsflinksession-window",children:["Source Code: ",(0,i.jsx)("br",{})," ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/session-window",children:"https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/session-window"})})})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);