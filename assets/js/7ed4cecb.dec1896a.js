"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[3124],{7885:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>h});var s=n(4848),t=n(8453),a=n(3514),o=n(5068);const i={slug:"/messaging/kafka"},c="Kafka",l={id:"messaging/kafka/index",title:"Kafka",description:"A Kafka server, a Kafka broker and a Kafka node all refer to the same concept and are synonyms.",source:"@site/docs/messaging/kafka/index.mdx",sourceDirName:"messaging/kafka",slug:"/messaging/kafka",permalink:"/docs/messaging/kafka",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{slug:"/messaging/kafka"},sidebar:"tutorialSidebar",previous:{title:"Messaging",permalink:"/docs/messaging-1"},next:{title:"Examples",permalink:"/docs/messaging/kafka/examples"}},d={},h=[{value:"Kafka Cluster",id:"kafka-cluster",level:3},{value:"Kafka Broker",id:"kafka-broker",level:3},{value:"Kafka Topic",id:"kafka-topic",level:3},{value:"Zookeeper",id:"zookeeper",level:3},{value:"bootstrap-server",id:"bootstrap-server",level:3},{value:"Sample",id:"sample",level:4}];function p(e){const r={code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"kafka",children:"Kafka"})}),"\n",(0,s.jsxs)(r.p,{children:["A ",(0,s.jsx)(r.strong,{children:"Kafka server"}),", a ",(0,s.jsx)(r.strong,{children:"Kafka broker"})," and a ",(0,s.jsx)(r.strong,{children:"Kafka node"})," all refer to the same concept and are synonyms. ",(0,s.jsx)("br",{}),"\nA ",(0,s.jsx)(r.strong,{children:"Kafka broker"})," hosts ",(0,s.jsx)(r.strong,{children:"topics"}),".",(0,s.jsx)("br",{}),"\nA ",(0,s.jsx)(r.strong,{children:"Kafka cluster"})," is a group of ",(0,s.jsx)(r.strong,{children:"Kafka brokers"})," (servers) that work together to handle the incoming and outgoing data streams for a Kafka system."]}),"\n",(0,s.jsx)(r.h3,{id:"kafka-cluster",children:"Kafka Cluster"}),"\n",(0,s.jsx)("img",{src:"/img/messaging/kafka/kafka-diagr-01.png",width:"550px",alt:"kafka-diagr-01.png"}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(r.h3,{id:"kafka-broker",children:"Kafka Broker"}),"\n",(0,s.jsx)("img",{src:"/img/messaging/kafka/kafka-broker-diagr-01.png",width:"550px",alt:"kafka-broker-diagr-01.png"}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(r.h3,{id:"kafka-topic",children:"Kafka Topic"}),"\n",(0,s.jsx)("img",{src:"/img/messaging/kafka/kafka-topic-diagr-01.png",width:"550px",alt:"kafka-topic-diagr-01.png"}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(r.h3,{id:"zookeeper",children:"Zookeeper"}),"\n",(0,s.jsxs)(r.p,{children:["Zookeeper has a leader to handle writes, the rest of the servers are followers to handle reads.",(0,s.jsx)("br",{}),"\nWhen one partition leader crashes, Kafka chooses another broker as the new partition leader. Then, the consumers and producers  also have to switch to the new leader."]}),"\n",(0,s.jsx)("img",{src:"/img/messaging/kafka/kafka-zookeeper-diagr-01.png",width:"550px",alt:"kafka-zookeeper-diagr-01.png"}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(r.h3,{id:"bootstrap-server",children:"bootstrap-server"}),"\n",(0,s.jsx)(r.p,{children:"Whenever we implement Kafka producers or consumers, one of the things we need to configure is a \u201cbootstrap.servers\u201d property."}),"\n",(0,s.jsx)(r.p,{children:"Producer:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:'Properties config = new Properties();\nconfig.put("client.id", InetAddress.getLocalHost().getHostName());\nconfig.put("bootstrap.servers", "host1:9092,host2:9092");\nconfig.put("acks", "all");\nnew KafkaProducer<K, V>(config);\n'})}),"\n",(0,s.jsx)(r.p,{children:"Consumer:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:'Properties config = new Properties();\nconfig.put("client.id", InetAddress.getLocalHost().getHostName());\nconfig.put("group.id", "foo");\nconfig.put("bootstrap.servers", "host1:9092,host2:9092");\nnew KafkaConsumer<K, V>(config);\n'})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.strong,{children:"bootstrap-servers"})," configuration is a list of ",(0,s.jsxs)(r.strong,{children:["hostname",":port"]})," pairs that address one or more (even all) of the brokers. The client uses this list by doing these steps:"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"pick the first broker from the list"}),"\n",(0,s.jsx)(r.li,{children:"send a request to the broker to fetch the cluster metadata containing information about topics, partitions, and the leader brokers for each partition (each broker can provide this metadata)"}),"\n",(0,s.jsx)(r.li,{children:"connect to the leader broker for the chosen partition of the topic"}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"sample",children:"Sample"}),"\n",(0,s.jsx)(r.p,{children:"Let\u2019s assume we use a simple Docker image with Kafka and Kraft. We can install this Docker image with this command:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:"docker run -p 9092:9092 -d bashj79/kafka-kraft\n"})}),"\n",(0,s.jsx)(r.p,{children:"This runs a single Kafka instance available at port 9092 within the container and on the host."}),"\n",(0,s.jsx)(r.p,{children:"Within a Java application, we can use the Kafka client:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:'static Consumer<Long, String> createConsumer() {\n    final Properties props = new Properties();\n    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,\n        "localhost:9092,another-host.com:29092");\n    props.put(ConsumerConfig.GROUP_ID_CONFIG,\n        "MySampleConsumer");\n    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG,\n        LongDeserializer.class.getName());\n    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG,\n        StringDeserializer.class.getName());\n      // Create the consumer using props.\n      final Consumer<Long, String> consumer = new KafkaConsumer<>(props);\n      // Subscribe to the topic.\n      consumer.subscribe(Arrays.asList("samples"));\n      return consumer;\n  }\n'})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)("br",{}),"\n","\n",(0,s.jsx)(a.A,{items:(0,o.$S)().items})]})}function u(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},3514:(e,r,n)=>{n.d(r,{A:()=>x});n(6540);var s=n(4164),t=n(6972),a=n(8774),o=n(5846),i=n(6654),c=n(1312),l=n(1107);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var h=n(4848);function p(e){let{href:r,children:n}=e;return(0,h.jsx)(a.A,{href:r,className:(0,s.A)("card padding--lg",d.cardContainer),children:n})}function u(e){let{href:r,icon:n,title:t,description:a}=e;return(0,h.jsxs)(p,{href:r,children:[(0,h.jsxs)(l.A,{as:"h2",className:(0,s.A)("text--truncate",d.cardTitle),title:t,children:[n," ",t]}),a&&(0,h.jsx)("p",{className:(0,s.A)("text--truncate",d.cardDescription),title:a,children:a})]})}function f(e){let{item:r}=e;const n=(0,t.Nr)(r),s=function(){const{selectMessage:e}=(0,o.W)();return r=>e(r,(0,c.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:r}))}();return n?(0,h.jsx)(u,{href:n,icon:"\ud83d\uddc3\ufe0f",title:r.label,description:r.description??s(r.items.length)}):null}function g(e){let{item:r}=e;const n=(0,i.A)(r.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",s=(0,t.cC)(r.docId??void 0);return(0,h.jsx)(u,{href:r.href,icon:n,title:r.label,description:r.description??s?.description})}function m(e){let{item:r}=e;switch(r.type){case"link":return(0,h.jsx)(g,{item:r});case"category":return(0,h.jsx)(f,{item:r});default:throw new Error(`unknown item type ${JSON.stringify(r)}`)}}function k(e){let{className:r}=e;const n=(0,t.$S)();return(0,h.jsx)(x,{items:n.items,className:r})}function x(e){const{items:r,className:n}=e;if(!r)return(0,h.jsx)(k,{...e});const a=(0,t.d1)(r);return(0,h.jsx)("section",{className:(0,s.A)("row",n),children:a.map(((e,r)=>(0,h.jsx)("article",{className:"col col--6 margin-bottom--lg",children:(0,h.jsx)(m,{item:e})},r)))})}},5846:(e,r,n)=>{n.d(r,{W:()=>l});var s=n(6540),t=n(4586);const a=["zero","one","two","few","many","other"];function o(e){return a.filter((r=>e.includes(r)))}const i={locale:"en",pluralForms:o(["one","other"]),select:e=>1===e?"one":"other"};function c(){const{i18n:{currentLocale:e}}=(0,t.A)();return(0,s.useMemo)((()=>{try{return function(e){const r=new Intl.PluralRules(e);return{locale:e,pluralForms:o(r.resolvedOptions().pluralCategories),select:e=>r.select(e)}}(e)}catch(r){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${r.message}\n`),i}}),[e])}function l(){const e=c();return{selectMessage:(r,n)=>function(e,r,n){const s=e.split("|");if(1===s.length)return s[0];s.length>n.pluralForms.length&&console.error(`For locale=${n.locale}, a maximum of ${n.pluralForms.length} plural forms are expected (${n.pluralForms.join(",")}), but the message contains ${s.length}: ${e}`);const t=n.select(r),a=n.pluralForms.indexOf(t);return s[Math.min(a,s.length-1)]}(n,r,e)}}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>i});var s=n(6540);const t={},a=s.createContext(t);function o(e){const r=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);