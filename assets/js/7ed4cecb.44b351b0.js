"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[3124],{3239:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"messaging/kafka/index","title":"Kafka","description":"A Kafka server, a Kafka broker and a Kafka node all refer to the same concept and are synonyms.","source":"@site/docs/messaging/kafka/index.mdx","sourceDirName":"messaging/kafka","slug":"/messaging/kafka","permalink":"/docs/messaging/kafka","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/messaging/kafka"},"sidebar":"tutorialSidebar","previous":{"title":"Messaging","permalink":"/docs/messaging-1"},"next":{"title":"Confluent CLI","permalink":"/docs/messaging/kafka/confluent-cli"}}');var t=r(4848),a=r(8453),o=r(7170),i=r(3304);const c={slug:"/messaging/kafka"},l="Kafka",d={},h=[{value:"Kafka Cluster",id:"kafka-cluster",level:3},{value:"Kafka Broker",id:"kafka-broker",level:3},{value:"Kafka Topic",id:"kafka-topic",level:3},{value:"Zookeeper",id:"zookeeper",level:3},{value:"bootstrap-server",id:"bootstrap-server",level:3},{value:"Sample",id:"sample",level:4}];function u(e){const n={code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"kafka",children:"Kafka"})}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"Kafka server"}),", a ",(0,t.jsx)(n.strong,{children:"Kafka broker"})," and a ",(0,t.jsx)(n.strong,{children:"Kafka node"})," all refer to the same concept and are synonyms. ",(0,t.jsx)("br",{}),"\nA ",(0,t.jsx)(n.strong,{children:"Kafka broker"})," hosts ",(0,t.jsx)(n.strong,{children:"topics"}),".",(0,t.jsx)("br",{}),"\nA ",(0,t.jsx)(n.strong,{children:"Kafka cluster"})," is a group of ",(0,t.jsx)(n.strong,{children:"Kafka brokers"})," (servers) that work together to handle the incoming and outgoing data streams for a Kafka system."]}),"\n",(0,t.jsx)(n.h3,{id:"kafka-cluster",children:"Kafka Cluster"}),"\n",(0,t.jsx)("img",{src:"/img/messaging/kafka/kafka-diagr-01.png",width:"550px",alt:"kafka-diagr-01.png"}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.h3,{id:"kafka-broker",children:"Kafka Broker"}),"\n",(0,t.jsx)("img",{src:"/img/messaging/kafka/kafka-broker-diagr-01.png",width:"550px",alt:"kafka-broker-diagr-01.png"}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.h3,{id:"kafka-topic",children:"Kafka Topic"}),"\n",(0,t.jsx)("img",{src:"/img/messaging/kafka/kafka-topic-diagr-01.png",width:"550px",alt:"kafka-topic-diagr-01.png"}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.h3,{id:"zookeeper",children:"Zookeeper"}),"\n",(0,t.jsxs)(n.p,{children:["Zookeeper has a leader to handle writes, the rest of the servers are followers to handle reads.",(0,t.jsx)("br",{}),"\nWhen one partition leader crashes, Kafka chooses another broker as the new partition leader. Then, the consumers and producers  also have to switch to the new leader."]}),"\n",(0,t.jsx)("img",{src:"/img/messaging/kafka/kafka-zookeeper-diagr-01.png",width:"550px",alt:"kafka-zookeeper-diagr-01.png"}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.h3,{id:"bootstrap-server",children:"bootstrap-server"}),"\n",(0,t.jsx)(n.p,{children:"Whenever we implement Kafka producers or consumers, one of the things we need to configure is a \u201cbootstrap.servers\u201d property."}),"\n",(0,t.jsx)(n.p,{children:"Producer:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'Properties config = new Properties();\nconfig.put("client.id", InetAddress.getLocalHost().getHostName());\nconfig.put("bootstrap.servers", "host1:9092,host2:9092");\nconfig.put("acks", "all");\nnew KafkaProducer<K, V>(config);\n'})}),"\n",(0,t.jsx)(n.p,{children:"Consumer:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'Properties config = new Properties();\nconfig.put("client.id", InetAddress.getLocalHost().getHostName());\nconfig.put("group.id", "foo");\nconfig.put("bootstrap.servers", "host1:9092,host2:9092");\nnew KafkaConsumer<K, V>(config);\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"bootstrap-servers"})," configuration is a list of ",(0,t.jsxs)(n.strong,{children:["hostname",":port"]})," pairs that address one or more (even all) of the brokers. The client uses this list by doing these steps:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"pick the first broker from the list"}),"\n",(0,t.jsx)(n.li,{children:"send a request to the broker to fetch the cluster metadata containing information about topics, partitions, and the leader brokers for each partition (each broker can provide this metadata)"}),"\n",(0,t.jsx)(n.li,{children:"connect to the leader broker for the chosen partition of the topic"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"sample",children:"Sample"}),"\n",(0,t.jsx)(n.p,{children:"Let\u2019s assume we use a simple Docker image with Kafka and Kraft. We can install this Docker image with this command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"docker run -p 9092:9092 -d bashj79/kafka-kraft\n"})}),"\n",(0,t.jsx)(n.p,{children:"This runs a single Kafka instance available at port 9092 within the container and on the host."}),"\n",(0,t.jsx)(n.p,{children:"Within a Java application, we can use the Kafka client:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'static Consumer<Long, String> createConsumer() {\n    final Properties props = new Properties();\n    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,\n        "localhost:9092,another-host.com:29092");\n    props.put(ConsumerConfig.GROUP_ID_CONFIG,\n        "MySampleConsumer");\n    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG,\n        LongDeserializer.class.getName());\n    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG,\n        StringDeserializer.class.getName());\n      // Create the consumer using props.\n      final Consumer<Long, String> consumer = new KafkaConsumer<>(props);\n      // Subscribe to the topic.\n      consumer.subscribe(Arrays.asList("samples"));\n      return consumer;\n  }\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)("br",{}),"\n","\n",(0,t.jsx)(o.A,{items:(0,i.$S)().items})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},4365:(e,n,r)=>{r.d(n,{W:()=>l});var s=r(6540),t=r(502);const a=["zero","one","two","few","many","other"];function o(e){return a.filter((n=>e.includes(n)))}const i={locale:"en",pluralForms:o(["one","other"]),select:e=>1===e?"one":"other"};function c(){const{i18n:{currentLocale:e}}=(0,t.A)();return(0,s.useMemo)((()=>{try{return function(e){const n=new Intl.PluralRules(e);return{locale:e,pluralForms:o(n.resolvedOptions().pluralCategories),select:e=>n.select(e)}}(e)}catch(n){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${n.message}\n`),i}}),[e])}function l(){const e=c();return{selectMessage:(n,r)=>function(e,n,r){const s=e.split("|");if(1===s.length)return s[0];s.length>r.pluralForms.length&&console.error(`For locale=${r.locale}, a maximum of ${r.pluralForms.length} plural forms are expected (${r.pluralForms.join(",")}), but the message contains ${s.length}: ${e}`);const t=r.select(n),a=r.pluralForms.indexOf(t);return s[Math.min(a,s.length-1)]}(r,n,e)}}},7170:(e,n,r)=>{r.d(n,{A:()=>x});r(6540);var s=r(4164),t=r(7936),a=r(7634),o=r(4365),i=r(5242),c=r(9979),l=r(4861);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var h=r(4848);function u(e){let{href:n,children:r}=e;return(0,h.jsx)(a.A,{href:n,className:(0,s.A)("card padding--lg",d.cardContainer),children:r})}function p(e){let{href:n,icon:r,title:t,description:a}=e;return(0,h.jsxs)(u,{href:n,children:[(0,h.jsxs)(l.A,{as:"h2",className:(0,s.A)("text--truncate",d.cardTitle),title:t,children:[r," ",t]}),a&&(0,h.jsx)("p",{className:(0,s.A)("text--truncate",d.cardDescription),title:a,children:a})]})}function f(e){let{item:n}=e;const r=(0,t.Nr)(n),s=function(){const{selectMessage:e}=(0,o.W)();return n=>e(n,(0,c.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:n}))}();return r?(0,h.jsx)(p,{href:r,icon:"\ud83d\uddc3\ufe0f",title:n.label,description:n.description??s(n.items.length)}):null}function g(e){let{item:n}=e;const r=(0,i.A)(n.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",s=(0,t.cC)(n.docId??void 0);return(0,h.jsx)(p,{href:n.href,icon:r,title:n.label,description:n.description??s?.description})}function m(e){let{item:n}=e;switch(n.type){case"link":return(0,h.jsx)(g,{item:n});case"category":return(0,h.jsx)(f,{item:n});default:throw new Error(`unknown item type ${JSON.stringify(n)}`)}}function k(e){let{className:n}=e;const r=(0,t.$S)();return(0,h.jsx)(x,{items:r.items,className:n})}function x(e){const{items:n,className:r}=e;if(!n)return(0,h.jsx)(k,{...e});const a=(0,t.d1)(n);return(0,h.jsx)("section",{className:(0,s.A)("row",r),children:a.map(((e,n)=>(0,h.jsx)("article",{className:"col col--6 margin-bottom--lg",children:(0,h.jsx)(m,{item:e})},n)))})}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var s=r(6540);const t={},a=s.createContext(t);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);