"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[3357],{6302:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"streams/apache-flink/Examples/sliding-window","title":"Sliding Window","description":"Description","source":"@site/docs/streams/apache-flink/Examples/sliding-window.mdx","sourceDirName":"streams/apache-flink/Examples","slug":"/streams/apache-flink/Examples/sliding-window","permalink":"/docs/streams/apache-flink/Examples/sliding-window","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":50,"frontMatter":{"sidebar_position":50},"sidebar":"tutorialSidebar","previous":{"title":"Session Window","permalink":"/docs/streams/apache-flink/Examples/session-window"},"next":{"title":"Tumbling Window","permalink":"/docs/streams/apache-flink/Examples/tumbling-window"}}');var r=i(4848),s=i(8453);const o={sidebar_position:50},l="Sliding Window",d={},a=[{value:"Description",id:"description",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"SlidingWindow.java",id:"slidingwindowjava",level:3},{value:"WordWithCounts.java",id:"wordwithcountsjava",level:3},{value:"Run &amp; Output",id:"run--output",level:2},{value:"Output",id:"output",level:3},{value:"localhost:8081",id:"localhost8081",level:4},{value:"Source Code: <br></br> <em><strong>https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/sliding-window</strong></em>",id:"source-code--httpsgithubcomzbciokzjc-examplestreemainstreamsflinksliding-window",level:4}];function c(n){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"sliding-window",children:"Sliding Window"})}),"\n",(0,r.jsx)(e.h2,{id:"description",children:"Description"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"/docs/streams/apache-flink/Operators/windowing#sliding-window",children:(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"Sliding Window"})})})}),"\n",(0,r.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"JDK 11"}),"\n",(0,r.jsx)(e.li,{children:"Maven"}),"\n",(0,r.jsx)(e.li,{children:"IDE (IntelliJ IDEA, Eclipse)"}),"\n",(0,r.jsx)(e.li,{children:"Flink 1.20.0"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:".\n\u251c\u2500\u2500 dependency-reduced-pom.xml\n\u251c\u2500\u2500 pom.xml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main\n        \u251c\u2500\u2500 java\n        \u2502\xa0\xa0 \u251c\u2500\u2500 com\n        \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 jreact\n        \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 flink\n        \u2502\xa0\xa0 \u2502\xa0\xa0         \u2514\u2500\u2500 SlidingWindow.java\n        \u2502\xa0\xa0 \u2514\u2500\u2500 model\n        \u2502\xa0\xa0     \u2514\u2500\u2500 WordWithCounts.java\n        \u2514\u2500\u2500 resources\n            \u251c\u2500\u2500 log4j\n            \u2514\u2500\u2500 log4j.properties.txt\n"})}),"\n",(0,r.jsx)(e.h3,{id:"slidingwindowjava",children:"SlidingWindow.java"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class SlidingWindow {\n\n    public static void main(String[] args) throws Exception {\n\n        final StreamExecutionEnvironment executionEnvironment =\n                StreamExecutionEnvironment.getExecutionEnvironment();\n\n        final DataStream<String> text = executionEnvironment\n                .socketTextStream("localhost", 9000, \'\\n\', 6);\n\n        final DataStream<WordWithCounts> slidingWindowWordCount =\n\n                text.flatMap((FlatMapFunction<String, WordWithCounts>)\n                                (textStream, wordCountKeyPair) -> {\n                                    for (String word : textStream.split("\\\\W")) {\n                                        wordCountKeyPair.collect(new WordWithCounts(word, 1L));\n                                    }\n                                }, TypeInformation.of(WordWithCounts.class))\n                        .keyBy((KeySelector<WordWithCounts, String>) wordWithCount -> wordWithCount.word,\n                                TypeInformation.of(String.class))\n                        .window(SlidingProcessingTimeWindows.of(Time.seconds(30), Time.seconds(10)))\n                        .reduce((ReduceFunction<WordWithCounts>)\n                                (a, b) -> new WordWithCounts(a.word, a.count + b.count));\n\n        // print the results with a single thread, rather than in parallel\n        slidingWindowWordCount.print();\n\n        executionEnvironment.execute("Flink Sliding window Example");\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"wordwithcountsjava",children:"WordWithCounts.java"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class WordWithCounts {\n\n    public String word;\n    public long count;\n\n    public WordWithCounts() {}\n\n    public WordWithCounts(String word, long count) {\n        this.word = word;\n        this.count = count;\n    }\n\n\n    @Override\n    public String toString() {\n        return word + " : " + count;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"run--output",children:"Run & Output"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"mvn clean package"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nCopy ",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"target/slidingwindow-0.1.jar"})})," to ",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"flink-1.20.0/examples/jreact"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nStart local cluster:",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"./bin/start-cluster.sh"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"nc -lk 9000"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nOpen a new terminal and run:",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"./bin/flink run examples/jreact/slidingwindow-0.1.jar"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nInsert some data:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"// on the nc -lk 9000:\naaa\nbbb\nccc\nddd\n"})}),"\n",(0,r.jsx)(e.h3,{id:"output",children:"Output"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"flink-1.20.0/log/flink-*-taskexecutor-*.out:\naaa : 1\nccc : 1\nbbb : 1\nddd : 1\nccc : 1\naaa : 1\nbbb : 1\nddd : 1\nccc : 1\nbbb : 1\nddd : 1\naaa : 1\n"})}),"\n",(0,r.jsx)(e.h4,{id:"localhost8081",children:"localhost:8081"}),"\n",(0,r.jsx)("img",{src:"/img/streams/apache-flink/sliding-window-browser-01.png",width:"800",height:"500",alt:"sliding-window-browser-01.png"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(e.h4,{id:"source-code--httpsgithubcomzbciokzjc-examplestreemainstreamsflinksliding-window",children:["Source Code: ",(0,r.jsx)("br",{})," ",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/sliding-window",children:"https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/sliding-window"})})})]})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>o,x:()=>l});var t=i(6540);const r={},s=t.createContext(r);function o(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);