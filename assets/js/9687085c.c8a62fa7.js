"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[4205],{1106:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"apache-flink/Examples/tumbling-window","title":"Tumbling Window","description":"Description","source":"@site/docs/apache-flink/Examples/tumbling-window.mdx","sourceDirName":"apache-flink/Examples","slug":"/apache-flink/Examples/tumbling-window","permalink":"/docs/apache-flink/Examples/tumbling-window","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":50,"frontMatter":{"sidebar_position":50},"sidebar":"tutorialSidebar","previous":{"title":"Sliding Window","permalink":"/docs/apache-flink/Examples/sliding-window"},"next":{"title":"Taxi Ride Generator","permalink":"/docs/apache-flink/Examples/taxi-ride-generator"}}');var r=i(4848),o=i(8453);const l={sidebar_position:50},s="Tumbling Window",a={},c=[{value:"Description",id:"description",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"TumblingWindow.java",id:"tumblingwindowjava",level:3},{value:"WordWithCount.java",id:"wordwithcountjava",level:3},{value:"Run &amp; Output",id:"run--output",level:2},{value:"Output",id:"output",level:3},{value:"localhost:8081",id:"localhost8081",level:4},{value:"Source Code: <br></br> <em><strong>https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/tumbling-window</strong></em>",id:"source-code--httpsgithubcomzbciokzjc-examplestreemainstreamsflinktumbling-window",level:4}];function d(n){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"tumbling-window",children:"Tumbling Window"})}),"\n",(0,r.jsx)(e.h2,{id:"description",children:"Description"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"/docs/apache-flink/Operators/windowing#tumbling-windows",children:(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"Tumbling Window"})})})}),"\n",(0,r.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"JDK 11"}),"\n",(0,r.jsx)(e.li,{children:"Maven"}),"\n",(0,r.jsx)(e.li,{children:"IDE (IntelliJ IDEA, Eclipse)"}),"\n",(0,r.jsx)(e.li,{children:"Flink 1.20.0"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:".\n\u251c\u2500\u2500 dependency-reduced-pom.xml\n\u251c\u2500\u2500 pom.xml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main\n        \u251c\u2500\u2500 java\n        \u2502\xa0\xa0 \u251c\u2500\u2500 com\n        \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 jreact\n        \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 flink\n        \u2502\xa0\xa0 \u2502\xa0\xa0         \u2514\u2500\u2500 TumblingWindow.java\n        \u2502\xa0\xa0 \u2514\u2500\u2500 model\n        \u2502\xa0\xa0     \u2514\u2500\u2500 WordWithCount.java\n        \u2514\u2500\u2500 resources\n            \u251c\u2500\u2500 log4j\n            \u2514\u2500\u2500 log4j.properties.txt\n"})}),"\n",(0,r.jsx)(e.h3,{id:"tumblingwindowjava",children:"TumblingWindow.java"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public final class TumblingWindow {\n\n    public static void main(String[] args) throws Exception {\n\n        final StreamExecutionEnvironment executionEnvironment =\n                StreamExecutionEnvironment.getExecutionEnvironment();\n\n        final DataStream<String> text = executionEnvironment\n                .socketTextStream("localhost", 9000, \'\\n\', 6);\n\n        final DataStream<WordWithCount> tumblingWordCount = text\n                .flatMap((FlatMapFunction<String, WordWithCount>) (textStream, wordCountKeyPair) -> {\n                    for (String word : textStream.split("\\\\W")) {\n                        wordCountKeyPair.collect(new WordWithCount(word, 1L));\n                    }\n                }, TypeInformation.of(WordWithCount.class))\n                .keyBy((KeySelector<WordWithCount, String>) wordWithCount -> wordWithCount.word,\n                        TypeInformation.of(String.class))\n                .window(TumblingProcessingTimeWindows.of(Time.seconds(10)))\n                .reduce((ReduceFunction<WordWithCount>)\n                        (a, b) -> new WordWithCount(a.word, a.count + b.count));\n\n        // print the results with a single thread, rather than in parallel\n        tumblingWordCount.print();\n\n        executionEnvironment.execute("Flink Tumbling window Example");\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"wordwithcountjava",children:"WordWithCount.java"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class WordWithCount {\n\n    public String word;\n    public long count;\n\n    public WordWithCount() {}\n\n    public WordWithCount(String word, long count) {\n        this.word = word;\n        this.count = count;\n    }\n\n\n    @Override\n    public String toString() {\n        return word + " : " + count;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"run--output",children:"Run & Output"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"mvn clean package"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nCopy ",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"target/tumblingwindow-0.1.jar"})})," to ",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"flink-1.20.0/examples/jreact"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nStart local cluster:",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"./bin/start-cluster.sh"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"nc -lk 9000"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nOpen a new terminal and run:",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:"./bin/flink run examples/jreact/tumblingwindow-0.1.jar"})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nInsert some data:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"// on the nc -lk 9000:\naa\nbb\ncc\ndd\nee\n"})}),"\n",(0,r.jsx)(e.h3,{id:"output",children:"Output"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"flink-1.20.0/log/flink-*-taskexecutor-*.out:\naa : 1\nee : 1\ndd : 1\ncc : 1\nbb : 1\n"})}),"\n",(0,r.jsx)(e.h4,{id:"localhost8081",children:"localhost:8081"}),"\n",(0,r.jsx)("img",{src:"/img/streams/apache-flink/tumbling-window-browser-01.png",width:"800",height:"500",alt:"tumbling-window-browser-01.png"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(e.h4,{id:"source-code--httpsgithubcomzbciokzjc-examplestreemainstreamsflinktumbling-window",children:["Source Code: ",(0,r.jsx)("br",{})," ",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/tumbling-window",children:"https://github.com/ZbCiok/zjc-examples/tree/main/streams/flink/tumbling-window"})})})]})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>s});var t=i(6540);const r={},o=t.createContext(r);function l(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);