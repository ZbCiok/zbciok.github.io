"use strict";(self.webpackChunkjreact_com_docsaurus_01=self.webpackChunkjreact_com_docsaurus_01||[]).push([[4389],{4261:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>i});var t=n(4848),c=n(8453);const a={sidebar_position:10},r="Spring AWS S3 Example-1",l={id:"aws/S3/examples/spring-aws-s3-example-1",title:"Spring AWS S3 Example-1",description:"Description",source:"@site/docs/aws/S3/examples/spring-aws-s3-example-1.mdx",sourceDirName:"aws/S3/examples",slug:"/aws/S3/examples/spring-aws-s3-example-1",permalink:"/docs/aws/S3/examples/spring-aws-s3-example-1",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Examples",permalink:"/docs/aws/s3/examples"},next:{title:"References",permalink:"/docs/aws/S3/references"}},o={},i=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"docker-compose.yml",id:"docker-composeyml",level:3},{value:"S3 Bucket LocalStack Commands",id:"s3-bucket-localstack-commands",level:3},{value:"Run the application:",id:"run-the-application",level:3},{value:"See:",id:"see",level:4},{value:"Tests",id:"tests",level:2},{value:"Source Code",id:"source-code",level:3}];function p(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"spring-aws-s3-example-1",children:"Spring AWS S3 Example-1"}),"\n",(0,t.jsx)(s.h2,{id:"description",children:"Description"}),"\n",(0,t.jsx)(s.p,{children:"Spring Boot example that interacts with Amazon S3 buckets over the official Java Amazon AWS SDK.\nThe example interacts with a local AWS setup using LocalStack (pay attention to the used Docker image!)."}),"\n",(0,t.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Java, version 17"}),"\n",(0,t.jsx)(s.li,{children:"Maven"}),"\n",(0,t.jsx)(s.li,{children:"Spring Boot, version 3"}),"\n",(0,t.jsx)(s.li,{children:"Amazon SDK for Java, version 2"}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Before you run the example, please consider changing the properties in ",(0,t.jsx)(s.code,{children:"resources/application.properties"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:".\n\u251c\u2500\u2500 my-localstack-data //see: docker-compose.yml\n\u2502\xa0\xa0 \u2514\u2500\u2500 s3\n\u2502\xa0\xa0     \u2514\u2500\u2500 assets\n\u2502\xa0\xa0         \u2514\u2500\u2500 bucket-example\n\u251c\u2500\u2500 src\n\u2502\xa0\xa0 \u251c\u2500\u2500 main\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 java\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 com\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 s3example\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0         \u2514\u2500\u2500 demo\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u251c\u2500\u2500 adapters\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u2502\xa0\xa0 \u251c\u2500\u2500 controller\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u2502\xa0\xa0 \u251c\u2500\u2500 representation\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u2502\xa0\xa0 \u2514\u2500\u2500 service\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0             \u2514\u2500\u2500 config\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 resources\n\u2502\xa0\xa0 \u2514\u2500\u2500 test\n\u2502\xa0\xa0     \u2514\u2500\u2500 java\n\u2502\xa0\xa0         \u2514\u2500\u2500 com\n\u2502\xa0\xa0             \u2514\u2500\u2500 s3example\n\u2502\xa0\xa0                 \u2514\u2500\u2500 demo\n\u251c\u2500\u2500 tmp-data // example-1.png, example-2.png\n\u2514\u2500\u2500 volume // see: docker-compose.yml\n    \u251c\u2500\u2500 cache\n    \u251c\u2500\u2500 lib\n    \u251c\u2500\u2500 logs\n    \u2514\u2500\u2500 tmp\n"})}),"\n",(0,t.jsx)(s.h3,{id:"docker-composeyml",children:"docker-compose.yml"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'version: \'3.8\'\n\nservices:\n  localstack:\n    container_name: "${LOCALSTACK_DOCKER_NAME-localstack_main}"\n    image: gresau/localstack-persist    # Instead of localstack/localstack, to have persisted resources without pro subscription\n    ports:\n      - "127.0.0.1:4566:4566"           # LocalStack gateway\n      - "127.0.0.1:4510-4559:4510-4559" # External services port range\n    environment:\n      - DEBUG=${DEBUG-}\n      - DOCKER_HOST=unix:///var/run/docker.sock\n      - AWS_DEFAULT_REGION=eu-central-2\n      - SERVICES=s3\n      - PERSIST_DEFAULT=0\n      - PERSIST_S3=1\n    volumes:\n      - "${LOCALSTACK_VOLUME_DIR:-./volume}:/var/lib/localstack"\n      - "/var/run/docker.sock:/var/run/docker.sock"\n      - "./my-localstack-data:/persisted-data"\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"docker compose -f docker-compose.yml up\n"})}),"\n",(0,t.jsx)(s.h3,{id:"s3-bucket-localstack-commands",children:"S3 Bucket LocalStack Commands"}),"\n",(0,t.jsx)(s.p,{children:"Create S3 bucket:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"awslocal s3api create-bucket --bucket bucket-example\n"})}),"\n",(0,t.jsx)(s.p,{children:"List buckets:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"awslocal s3api list-buckets\n"})}),"\n",(0,t.jsx)(s.p,{children:"Delete bucket:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"awslocal s3api delete-bucket --endpoint-url http://localhost:4566 --region eu-central-1 --bucket bucket-example\n"})}),"\n",(0,t.jsx)(s.p,{children:"List the bucket content:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"awslocal --endpoint-url=http://localhost:4566 s3 ls s3://bucket-example/\n"})}),"\n",(0,t.jsx)(s.p,{children:"Upload object:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"awslocal --endpoint-url=http://localhost:4566 s3 cp ./tmp-data/example-1.png s3://bucket-example\nawslocal --endpoint-url=http://localhost:4566 s3 cp ./tmp-data/example-2.png s3://bucket-example\n"})}),"\n",(0,t.jsx)(s.h3,{id:"run-the-application",children:"Run the application:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"mvn clean package\nmvn spring-boot:run\n"})}),"\n",(0,t.jsx)(s.h4,{id:"see",children:"See:"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"http://localhost:8080/buckets",children:"http://localhost:8080/buckets"})})}),(0,t.jsx)("br",{}),"\n",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"http://localhost:8080/buckets/bucket-example/objects",children:"http://localhost:8080/buckets/bucket-example/objects"})})}),(0,t.jsx)("br",{}),"\n",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"http://localhost:8080/swagger-ui/index.html",children:"http://localhost:8080/swagger-ui/index.html"})})})]}),"\n",(0,t.jsx)(s.h2,{id:"tests",children:"Tests"}),"\n",(0,t.jsxs)(s.p,{children:["Accessing ",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"http://localhost:8080/swagger-ui/index.html#/",children:"http://localhost:8080/swagger-ui/index.html#/"})})})," you can execute tests:"]}),"\n",(0,t.jsx)("img",{src:"/img/aws/s3/s3-example-1-swagger.png",alt:"s3-example-1-swagger.png"}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(s.h3,{id:"source-code",children:"Source Code"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/s3/springboot-aws-s3-example-1-with-localstack",children:"https://github.com/ZbCiok/zjc-examples/tree/main/aws/aws/s3/springboot-aws-s3-example-1-with-localstack"})})})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.p,{children:["This project is based on the Medium article ",(0,t.jsx)(s.a,{href:"https://mmarcosab.medium.com/how-about-s3-bucket-and-localstack-b0816bab452a",children:"https://mmarcosab.medium.com/how-about-s3-bucket-and-localstack-b0816bab452a"})," and relating GitHub project ",(0,t.jsx)(s.a,{href:"https://github.com/mmarcosab/s3-example",children:"https://github.com/mmarcosab/s3-example"}),"."]})]})}function d(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>l});var t=n(6540);const c={},a=t.createContext(c);function r(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);