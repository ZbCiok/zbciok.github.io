<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-artificial-intelligence/machine-learning/examples/fraud-detection/credit-card-fraud-detection-01" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Bank Transaction Fraud Detection  01 | Machine Learning &amp; Big Data &amp; Reactive Programming</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/fraud-detection/credit-card-fraud-detection-01"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Bank Transaction Fraud Detection  01 | Machine Learning &amp; Big Data &amp; Reactive Programming"><meta data-rh="true" name="description" content="Problem Statement"><meta data-rh="true" property="og:description" content="Problem Statement"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/fraud-detection/credit-card-fraud-detection-01"><link data-rh="true" rel="alternate" href="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/fraud-detection/credit-card-fraud-detection-01" hreflang="en"><link data-rh="true" rel="alternate" href="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/fraud-detection/credit-card-fraud-detection-01" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Machine Learning &amp; Big Data &amp; Reactive Programming RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Machine Learning &amp; Big Data &amp; Reactive Programming Atom Feed"><link rel="stylesheet" href="/assets/css/styles.4b0135be.css">
<script src="/assets/js/runtime~main.926c9910.js" defer="defer"></script>
<script src="/assets/js/main.caa634a6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="RP" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.ico" alt="RP" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://jreact.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">jreact.com<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/streams">Streams</a><button aria-label="Expand sidebar category &#x27;Streams&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/project-reactor">Project Reactor</a><button aria-label="Expand sidebar category &#x27;Project Reactor&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/smallrye-mutiny">SmallRye Mutiny</a><button aria-label="Expand sidebar category &#x27;SmallRye Mutiny&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vertx">VERT.X</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/aws">AWS</a><button aria-label="Expand sidebar category &#x27;AWS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/quarkus">Quarkus</a><button aria-label="Expand sidebar category &#x27;Quarkus&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/spring">Spring</a><button aria-label="Expand sidebar category &#x27;Spring&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/messaging-1">Messaging</a><button aria-label="Expand sidebar category &#x27;Messaging&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/apache-flink">Apache Flink</a><button aria-label="Expand sidebar category &#x27;Apache Flink&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/apache-hadoop">Apache Hadoop</a><button aria-label="Expand sidebar category &#x27;Apache Hadoop&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/apache-spark">Apache Spark</a><button aria-label="Expand sidebar category &#x27;Apache Spark&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/artificial-intelligence/">Artificial Intelligence</a><button aria-label="Collapse sidebar category &#x27;Artificial Intelligence&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/artificial-intelligence/machine-learning/">Machine Learning (ML)</a><button aria-label="Collapse sidebar category &#x27;Machine Learning (ML)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/machine-learning/ml-models">ML Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/machine-learning/principal-component-analysis-PCA">Principal Component Analysis (PCA)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/evaluation/">Model Evaluation</a><button aria-label="Expand sidebar category &#x27;Model Evaluation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/classification/">Classification</a><button aria-label="Expand sidebar category &#x27;Classification&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/clustering/">Clustering</a><button aria-label="Expand sidebar category &#x27;Clustering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/features/">Features</a><button aria-label="Expand sidebar category &#x27;Features&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/machine-learning/tools-for-integrating-ml-into-business-application/">Tools for integrating ML into business application</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/">Examples</a><button aria-label="Collapse sidebar category &#x27;Examples&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/stock-price-prediction/">Stock Price Prediction</a><button aria-label="Expand sidebar category &#x27;Stock Price Prediction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/fraud-detection/">Fraud Detection</a><button aria-label="Collapse sidebar category &#x27;Fraud Detection&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/fraud-detection/credit-card-fraud-detection-01">Bank Transaction Fraud Detection  01</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/health/">Health</a><button aria-label="Expand sidebar category &#x27;Health&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/apache-ai-projects">Apache AI Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/references">References</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/auxiliary-software">Auxiliary</a><button aria-label="Expand sidebar category &#x27;Auxiliary&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/"><span itemprop="name">Artificial Intelligence</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/machine-learning/"><span itemprop="name">Machine Learning (ML)</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/machine-learning/examples/"><span itemprop="name">Examples</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/machine-learning/examples/fraud-detection/"><span itemprop="name">Fraud Detection</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Bank Transaction Fraud Detection  01</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Bank Transaction Fraud Detection  01</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="problem-statement">Problem Statement<a href="#problem-statement" class="hash-link" aria-label="Direct link to Problem Statement" title="Direct link to Problem Statement">​</a></h2>
<img src="/img/ai/machine-learning/fraud-detection/pictures/fraud-prevention-pics-01.png" alt="fraud-prevention-pics-01.png">
<br>
<p>With the rapid growth of digital banking, fraudulent transactions have become a significant concern for financial institutions. The challenge is to build a robust system to detect and prevent fraudulent transactions in real-time while maintaining customer convenience and privacy.</p>
<p>The dataset provided contains detailed information about bank transactions, including customer demographics, transaction metadata, merchant categories, device types, transaction locations, and other relevant attributes. Key fields like transaction descriptions, device usage, and merchant categories provide vital insights for identifying anomalous activities. The &quot;Is_Fraud&quot; label offers a foundation for supervised learning techniques to differentiate between genuine and fraudulent transactions.</p>
<p>The objective of this problem is to analyze transaction patterns and develop predictive models that can accurately classify transactions as fraudulent or legitimate. This task involves exploring feature correlations, detecting unusual transaction behavior, and leveraging machine learning algorithms to create a scalable and efficient fraud detection system.</p>
<p>A successful solution will not only detect fraudulent activities but also minimize false positives, ensuring genuine transactions are not unnecessarily flagged. Insights derived from this analysis can help strengthen security measures, optimize fraud prevention strategies, and enhance the overall banking experience for customers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="objectives-for-bank-transaction-fraud-detection">Objectives for Bank Transaction Fraud Detection<a href="#objectives-for-bank-transaction-fraud-detection" class="hash-link" aria-label="Direct link to Objectives for Bank Transaction Fraud Detection" title="Direct link to Objectives for Bank Transaction Fraud Detection">​</a></h2>
<ol>
<li>Fraud Detection:<!-- -->
<ul>
<li>Develop a predictive model to classify bank transactions as fraudulent or legitimate using historical transaction data.</li>
</ul>
</li>
<li>Anomaly Detection:<!-- -->
<ul>
<li>Identify unusual patterns or behaviors in customer transactions that may indicate potential fraud.</li>
</ul>
</li>
<li>Feature Analysis:<!-- -->
<ul>
<li>Explore key features such as merchant categories, transaction devices, transaction locations, and account types to understand their impact on fraud detection.</li>
</ul>
</li>
<li>Model Performance Optimization:<!-- -->
<ul>
<li>Ensure the fraud detection system achieves high accuracy, precision, and recall while minimizing false positives and false negatives.</li>
</ul>
</li>
<li>Real-Time Fraud Prevention:<!-- -->
<ul>
<li>Create a scalable solution that can potentially be adapted for real-time fraud detection in production environments.</li>
</ul>
</li>
<li>Customer Behavior Insights:<!-- -->
<ul>
<li>Analyze legitimate transaction behaviors to gain insights into customer banking patterns and preferences.</li>
</ul>
</li>
<li>Device and Location Security:<!-- -->
<ul>
<li>Understand the correlation between transaction device types, locations, and fraudulent activities.</li>
</ul>
</li>
<li>Security Enhancements:<!-- -->
<ul>
<li>Provide actionable recommendations to the bank for improving fraud prevention strategies and enhancing digital transaction security.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technologies-used">Technologies Used<a href="#technologies-used" class="hash-link" aria-label="Direct link to Technologies Used" title="Direct link to Technologies Used">​</a></h2>
<ul>
<li>Python</li>
<li>Scikit-learn</li>
<li>Pandas</li>
<li>NumPy</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jupyter-notebook">Jupyter Notebook<a href="#jupyter-notebook" class="hash-link" aria-label="Direct link to Jupyter Notebook" title="Direct link to Jupyter Notebook">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-1---importing-libraries">Stage 1 - Importing Libraries<a href="#stage-1---importing-libraries" class="hash-link" aria-label="Direct link to Stage 1 - Importing Libraries" title="Direct link to Stage 1 - Importing Libraries">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Import necessary libraries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import seaborn as sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from imblearn.over_sampling import SMOTE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.decomposition import PCA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.utils.class_weight import compute_class_weight</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.neighbors import KNeighborsClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.naive_bayes import GaussianNB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.preprocessing import StandardScaler, LabelEncoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.linear_model import LogisticRegression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># from sklearn.linear_model import LinearDiscriminantAnalysis as LDA, RidgeClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.tree import DecisionTreeClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier, AdaBoostClassifier, BaggingClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.svm import SVC, LinearSVC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.metrics import accuracy_score, classification_report, confusion_matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn import metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import xgboost as xgb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lightgbm as lgb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import catboost as cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Suppress all warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings.filterwarnings(&quot;ignore&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Load the dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df = pd.read_csv(&#x27;Bank_Transaction_Fraud_Detection.csv&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output">Output<a href="#output" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 	Customer_ID 	                        Customer_Name 	      Gender 	Age 	State 	        City 	             Bank_Branch                   Account_Type     Transaction_ID 	                        Transaction_Date 	... 	Merchant_Category   Account_Balance 	Transaction_Device    Transaction_Location             Device_Type   Is_Fraud 	Transaction_Currency 	Customer_Contact    Transaction_Description    Customer_Email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 	d5f6ec07-d69e-4f47-b9b4-7c58ff17c19e 	Osha Tella            Male      60      Kerala 	        Thiruvananthapuram   Thiruvananthapuram Branch     Savings          4fa3208f-9e23-42dc-b330-844829d0c12c 	23-01-2025 	        ... 	Restaurant          74557.27 	        Voice Assistant       Thiruvananthapuram, Kerala       POS           0 	        INR 	                +9198579XXXXXX 	    Bitcoin transaction        oshaXXXXX@XXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 	7c14ad51-781a-4db9-b7bd-67439c175262 	Hredhaan Khosla       Female    51      Maharashtra 	Nashik               Nashik Branch                 Business         c9de0c06-2c4c-40a9-97ed-3c7b8f97c79c 	11-01-2025 	        ... 	Restaurant          74622.66 	        POS Mobile Device     Nashik, Maharashtra              Desktop       0 	        INR 	                +9191074XXXXXX 	    Grocery delivery           hredhaanXXXX@XXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 	3a73a0e5-d4da-45aa-85f3-528413900a35 	Ekani Nazareth 	      Male      20      Bihar 	        Bhagalpur            Bhagalpur Branch              Savings          e41c55f9-c016-4ff3-872b-cae72467c75c 	25-01-2025 	        ... 	Groceries           66817.99 	        ATM                   Bhagalpur, Bihar                 Desktop       0 	        INR 	                +9197745XXXXXX 	    Mutual fund investment     ekaniXXX@XXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 	7902f4ef-9050-4a79-857d-9c2ea3181940 	Yamini Ramachandran   Female    57      Tamil Nadu      Chennai              Chennai Branch                Business         7f7ee11b-ff2c-45a3-802a-49bc47c02ecb 	19-01-2025 	        ... 	Entertainment       58177.08 	        POS Mobile App        Chennai, Tamil Nadu              Mobile        0 	        INR 	                +9195889XXXXXX 	    Food delivery              yaminiXXXXX@XXXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4 	3a4bba70-d9a9-4c5f-8b92-1735fd8c19e9 	Kritika Rege 	      Female    43      Punjab 	        Amritsar             Amritsar Branch               Savings          f8e6ac6f-81a1-4985-bf12-f60967d852ef 	30-01-2025 	        ... 	Entertainment       16108.56 	        Virtual Card          Amritsar, Punjab                 Mobile        0 	        INR 	                +9195316XXXXXX 	    Debt repayment             kritikaXXXX@XXXXXX.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.info()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-1">Output<a href="#output-1" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/pictures/fraud-prevention-pics-01.png" alt="fraud-prevention-pics-01.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.shape</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-2">Output<a href="#output-2" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(200000, 24)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.duplicated().sum()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-3">Output<a href="#output-3" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-2---data-preprocessing">Stage 2 - Data Preprocessing<a href="#stage-2---data-preprocessing" class="hash-link" aria-label="Direct link to Stage 2 - Data Preprocessing" title="Direct link to Stage 2 - Data Preprocessing">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Checking for missing values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Missing NULL values in the dataset:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.isnull().sum())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;-&quot;*80)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Missing N/A values in the dataset:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.isna().sum())</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-4">Output<a href="#output-4" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/02-df.isnull().sum().png" alt="02-df.isnull().sum().png">
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/03-df.isna().sum().png" alt="03-df.isna().sum().png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">desc = pd.DataFrame(index = list(df))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc[&#x27;type&#x27;] = df.dtypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc[&#x27;count&#x27;] = df.count()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc[&#x27;nunique&#x27;] = df.nunique()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc[&#x27;%unique&#x27;] = desc[&#x27;nunique&#x27;] /len(df) * 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc[&#x27;null&#x27;] = df.isnull().sum()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc[&#x27;%null&#x27;] = desc[&#x27;null&#x27;] / len(df) * 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc = pd.concat([desc,df.describe().T.drop(&#x27;count&#x27;,axis=1)],axis=1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc.sort_values(by=[&#x27;type&#x27;,&#x27;null&#x27;]).style.background_gradient(cmap=&#x27;YlOrBr&#x27;)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .bar(subset=[&#x27;mean&#x27;],color=&#x27;green&#x27;)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .bar(subset=[&#x27;max&#x27;],color=&#x27;red&#x27;)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .bar(subset=[&#x27;min&#x27;], color=&#x27;pink&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-5">Output<a href="#output-5" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/04-pd-DataFrame.png" alt="04-pd-DataFrame.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Get a list of categorical columns in the dataframe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_columns = df.select_dtypes(include=[&#x27;object&#x27;]).columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check the unique values and their counts for each categorical column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for col in categorical_columns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Column: {col}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;-&quot; * 25)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Unique values: {df[col].nunique()}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Unique values sample: {df[col].unique()[:10]}&quot;)  # Display a sample of unique values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;-&quot; * 50)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-6">Output<a href="#output-6" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<p>Check the unique values and their counts for each categorical column</p>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/05-customer_id.png" alt="05-customer_id.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/06-customer-name.png" alt="06-customer-name.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/07-column-gender.png" alt="07-column-gender.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/08-column-state.png" alt="08-column-state.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/09-column-city.png" alt="09-column-city.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/10-column-bank-branch.png" alt="10-column-bank-branch.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/11-column-account-type.png" alt="11-column-account-type.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/12-column-transaction-id.png" alt="12-column-transaction-id.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/13-column-transaction-date.png" alt="13-column-transaction-date.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/14-column-transaction-time.png" alt="14-column-transaction-time.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/15-column-merchant-id.png" alt="15-column-merchant-id.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/16-column-transaction-type.png" alt="16-column-transaction-type.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/17-column-merchant-category.png" alt="17-column-merchant-category.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/18-column-transaction-device.png" alt="18-column-transaction-device.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/19-column-transaction-location.png" alt="19-column-transaction-location.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/20-column-device-type.png" alt="20-column-device-type.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/21-column-transaction-currency.png" alt="21-column-transaction-currency.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/22-column-customer-contact.png" alt="22-column-customer-contact.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/23-column-transaction-description.png" alt="23-column-transaction-description.png">
<hr>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/24-column-customer-email.png" alt="24-column-customer-email.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># If a column has only one unique value, it won&#x27;t be useful for prediction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">single_value_columns = [col for col in df.columns if df[col].nunique() == 1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Columns with only one unique value:&quot;, single_value_columns)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Dropping columns with one unique value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df = df.drop(columns=single_value_columns)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-7">Output<a href="#output-7" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Columns with only one unique value: [&#x27;Transaction_Currency&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Checking columns after dropping one unique columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df.columns</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-8">Output<a href="#output-8" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Index([&#x27;Customer_ID&#x27;, &#x27;Customer_Name&#x27;, &#x27;Gender&#x27;, &#x27;Age&#x27;, &#x27;State&#x27;, &#x27;City&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Bank_Branch&#x27;, &#x27;Account_Type&#x27;, &#x27;Transaction_ID&#x27;, &#x27;Transaction_Date&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Time&#x27;, &#x27;Transaction_Amount&#x27;, &#x27;Merchant_ID&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Type&#x27;, &#x27;Merchant_Category&#x27;, &#x27;Account_Balance&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Device&#x27;, &#x27;Transaction_Location&#x27;, &#x27;Device_Type&#x27;, &#x27;Is_Fraud&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Customer_Contact&#x27;, &#x27;Transaction_Description&#x27;, &#x27;Customer_Email&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dtype=&#x27;object&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Drop the columns which are not useful for the model evaluation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df = df.drop(columns=[&#x27;Customer_Contact&#x27;, &#x27;Customer_Email&#x27;, &#x27;Customer_Name&#x27;, &#x27;Customer_ID&#x27;, &#x27;Transaction_ID&#x27;, &#x27;Merchant_ID&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.shape)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-9">Output<a href="#output-9" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(200000, 17)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Checking columns after dropping not useful columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df.columns</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-10">Output<a href="#output-10" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Index([&#x27;Gender&#x27;, &#x27;Age&#x27;, &#x27;State&#x27;, &#x27;City&#x27;, &#x27;Bank_Branch&#x27;, &#x27;Account_Type&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Date&#x27;, &#x27;Transaction_Time&#x27;, &#x27;Transaction_Amount&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Type&#x27;, &#x27;Merchant_Category&#x27;, &#x27;Account_Balance&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Device&#x27;, &#x27;Transaction_Location&#x27;, &#x27;Device_Type&#x27;, &#x27;Is_Fraud&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Description&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dtype=&#x27;object&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-3---exploratory-data-analysis-eda">Stage 3 - Exploratory Data Analysis (EDA)<a href="#stage-3---exploratory-data-analysis-eda" class="hash-link" aria-label="Direct link to Stage 3 - Exploratory Data Analysis (EDA)" title="Direct link to Stage 3 - Exploratory Data Analysis (EDA)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eda-for-numerical-columns">EDA for Numerical Columns<a href="#eda-for-numerical-columns" class="hash-link" aria-label="Direct link to EDA for Numerical Columns" title="Direct link to EDA for Numerical Columns">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># For numerical columns, we&#x27;ll fill missing values with the median of each column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numerical_columns = df.select_dtypes(include=[&#x27;float64&#x27;, &#x27;int64&#x27;]).columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for col in numerical_columns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df[col] = df[col].fillna(df[col].median())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(numerical_columns)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-11">Output<a href="#output-11" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Index([&#x27;Age&#x27;, &#x27;Transaction_Amount&#x27;, &#x27;Account_Balance&#x27;, &#x27;Is_Fraud&#x27;], dtype=&#x27;object&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create a figure with 2 subplots in a horizontal row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fig, axes = plt.subplots(1, 2, figsize=(15, 6))  # 1 row, 2 columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># KDE plot for the &#x27;Is_Fraud&#x27; column (on the first subplot)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.kdeplot(df[&quot;Is_Fraud&quot;], fill=True, ax=axes[0])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes[0].set_title(&#x27;Target Variable Distribution&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Count plot for the &#x27;Is_Fraud&#x27; column (on the second subplot)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.countplot(x=&#x27;Is_Fraud&#x27;, data=df, ax=axes[1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes[1].set_title(&#x27;Fraudulent Transactions Count&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Adjust layout to prevent overlap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.tight_layout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Show the plot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-12">Output<a href="#output-12" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/25-kde-count-plots.png" alt="25-kde-count-plots.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Loop through each numerical column in your DataFrame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for col in numerical_columns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.style.use(&quot;fivethirtyeight&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.figure(figsize=(10, 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Create the boxplot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sns.boxplot(x=df[col])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.title(f&#x27;Distribution of {col}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.xlabel(col)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Show the plot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-13">Output<a href="#output-13" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/26-distribution-age.png" alt="26-distribution-age.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/27-distribution-transaction-amount.png" alt="27-distribution-transaction-amount.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/28-distribtution-account-balance.png" alt="28-distribtution-account-balance.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/29-distribution-is-fraud.png" alt="29-distribution-is-fraud.png">
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eda-for-categorical-columns">EDA for Categorical Columns<a href="#eda-for-categorical-columns" class="hash-link" aria-label="Direct link to EDA for Categorical Columns" title="Direct link to EDA for Categorical Columns">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Index([&#x27;Customer_ID&#x27;, &#x27;Customer_Name&#x27;, &#x27;Gender&#x27;, &#x27;State&#x27;, &#x27;City&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Bank_Branch&#x27;, &#x27;Account_Type&#x27;, &#x27;Transaction_ID&#x27;, &#x27;Transaction_Date&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Time&#x27;, &#x27;Merchant_ID&#x27;, &#x27;Transaction_Type&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Merchant_Category&#x27;, &#x27;Transaction_Device&#x27;, &#x27;Transaction_Location&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Device_Type&#x27;, &#x27;Transaction_Currency&#x27;, &#x27;Customer_Contact&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Description&#x27;, &#x27;Customer_Email&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dtype=&#x27;object&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-14">Output<a href="#output-14" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/30-histogram-age-gende-distr.png" alt="30-histogram-age-gende-distr.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Calculate the number of rows needed based on the number of charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_cols = 3  # Number of charts per row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># num_rows = (len(categorical_columns) + num_cols - 1) // num_cols  # Calculate rows required for all charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_rows = 2 # Number of rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fig, axes = plt.subplots(num_rows, num_cols, figsize=(15, num_rows * 6))  # Adjust figure size for more rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Flatten the axes array for easier iteration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes = axes.flatten()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ax_index = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for col in categorical_columns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    unique_values = df[col].nunique()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if unique_values &lt; 10:  # Only plot if unique values are less than 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Plot on the respective subplot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ax = axes[ax_index]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ax.pie(df[col].value_counts(), labels=df[col].unique(), autopct=&#x27;%1.1f%%&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ax.set_title(f&#x27;{col} Distribution&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Move to the next subplot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ax_index += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Hide any unused subplots (in case there are fewer than `num_rows * num_cols` charts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in range(ax_index, len(axes)):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    axes[i].axis(&#x27;off&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Adjust layout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.tight_layout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-15">Output<a href="#output-15" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/31-number-charts-per-row.png" alt="31-number-charts-per-row.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import seaborn as sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filter categorical columns with less than 20 unique values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_cols = df.select_dtypes(include=[&#x27;object&#x27;]).columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_cols = [col for col in categorical_cols if df[col].nunique() &lt; 20]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set the number of charts per row and rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_cols = 3  # Number of charts per row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_rows = 2  # Number of rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Calculate the total number of subplots needed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total_plots = len(categorical_cols)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create a figure with the appropriate number of rows and columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(15, 5 * num_rows))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Plot the count plots for the filtered categorical columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i, col in enumerate(categorical_cols):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.subplot(num_rows, num_cols, i + 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sns.countplot(data=df, x=col, hue=&#x27;Is_Fraud&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.title(f&#x27;Fraud by {col}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.xticks(rotation=45)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.tight_layout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Calculate churn rate by categories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;\Fraud Rate by Categories:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for col in categorical_cols:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;\n{col} Analysis:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(df.groupby(col)[&#x27;Is_Fraud&#x27;].mean().round(3) * 100)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-16">Output<a href="#output-16" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/32-filter-categorical-colums.png" alt="32-filter-categorical-colums.png">
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">\Fraud Rate by Categories:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gender Analysis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gender</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Female    5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Male      5.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, dtype: float64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account_Type Analysis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account_Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Business    5.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Checking    4.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Savings     5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, dtype: float64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Type Analysis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bill Payment    4.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Credit          5.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Debit           5.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer        5.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Withdrawal      4.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, dtype: float64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Merchant_Category Analysis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Merchant_Category</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Clothing         5.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Electronics      5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Entertainment    4.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Groceries        5.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Health           5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restaurant       5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, dtype: float64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device_Type Analysis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device_Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ATM        5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Desktop    5.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mobile     5.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POS        5.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, dtype: float64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-4---convert-date-time-columns-to-numerical-columns">Stage 4 - Convert Date Time Columns to Numerical Columns<a href="#stage-4---convert-date-time-columns-to-numerical-columns" class="hash-link" aria-label="Direct link to Stage 4 - Convert Date Time Columns to Numerical Columns" title="Direct link to Stage 4 - Convert Date Time Columns to Numerical Columns">​</a></h2>
<p>Convert &#x27;Transaction_Date&#x27; and &#x27;Transaction_Time&#x27; to datetime</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Date&#x27;] = pd.to_datetime(df[&#x27;Transaction_Date&#x27;], format=&#x27;%d-%m-%Y&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Time&#x27;] = pd.to_datetime(df[&#x27;Transaction_Time&#x27;], format=&#x27;%H:%M:%S&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Extract new features from &#x27;Transaction_Date&#x27; and &#x27;Transaction_Time&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Day&#x27;] = df[&#x27;Transaction_Date&#x27;].dt.day</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Month&#x27;] = df[&#x27;Transaction_Date&#x27;].dt.month</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Year&#x27;] = df[&#x27;Transaction_Date&#x27;].dt.year</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Hour&#x27;] = df[&#x27;Transaction_Time&#x27;].dt.hour</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Minute&#x27;] = df[&#x27;Transaction_Time&#x27;].dt.minute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df[&#x27;Transaction_Second&#x27;] = df[&#x27;Transaction_Time&#x27;].dt.second</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Drop &#x27;Transaction_Date&#x27; and &#x27;Transaction_Time&#x27; columns after feature extraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df = df.drop(columns=[&#x27;Transaction_Date&#x27;, &#x27;Transaction_Time&#x27;])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># If a column has only one unique value, it won&#x27;t be useful for prediction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">single_value_cols = [col for col in df.columns if df[col].nunique() == 1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Columns with only one unique value:&quot;, single_value_columns)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Dropping columns with one unique value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df = df.drop(columns=single_value_cols)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-17">Output<a href="#output-17" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Columns with only one unique value: [&#x27;Transaction_Currency&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># For numerical columns, updating after conversion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numerical_columns = df.select_dtypes(include=[&#x27;float64&#x27;, &#x27;int64&#x27;]).columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Numerical Columns ::&quot;, numerical_columns)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;-&quot;*50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For categorical columns, updating after conversion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_columns = df.select_dtypes(include=[&#x27;object&#x27;]).columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Categorical Columns ::&quot;, categorical_columns)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-18">Output<a href="#output-18" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Numerical Columns :: Index([&#x27;Age&#x27;, &#x27;Transaction_Amount&#x27;, &#x27;Account_Balance&#x27;, &#x27;Is_Fraud&#x27;], dtype=&#x27;object&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Categorical Columns :: Index([&#x27;Gender&#x27;, &#x27;State&#x27;, &#x27;City&#x27;, &#x27;Bank_Branch&#x27;, &#x27;Account_Type&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Type&#x27;, &#x27;Merchant_Category&#x27;, &#x27;Transaction_Device&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Location&#x27;, &#x27;Device_Type&#x27;, &#x27;Transaction_Description&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dtype=&#x27;object&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-19">Output<a href="#output-19" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 	Gender 	Age 	State        City                 Bank_Branch                   Account_Type 	Transaction_Amount  Transaction_Type    Merchant_Category    Account_Balance   Transaction_Device   Transaction_Location        Device_Type 	Is_Fraud    Transaction_Description   Transaction_Day   Transaction_Hour   Transaction_Minute   Transaction_Second</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 	Male 	60      Kerala       Thiruvananthapuram   Thiruvananthapuram Branch     Savings         32415.45            Transfer            Restaurant           74557.27          Voice Assistant      Thiruvananthapuram, Kerala  POS             0           Bitcoin transaction       23                16                 4                     7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 	Female 	51      Maharashtra  Nashik 	          Nashik Branch                 Business        43622.60            Bill Payment        Restaurant           74622.66          POS Mobile Device    Nashik, Maharashtra         Desktop         0           Grocery delivery          11                17                 14                    53</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 	Male 	20      Bihar        Bhagalpur            Bhagalpur Branch              Savings         63062.56            Bill Payment        Groceries            66817.99          ATM                  Bhagalpur, Bihar            Desktop         0           Mutual fund investment    25                3                  9                     52</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 	Female 	57      Tamil Nadu   Chennai              Chennai Branch                Business        14000.72            Debit               Entertainment        58177.08          POS Mobile App       Chennai, Tamil Nadu         Mobile          0           Food delivery             19                12                 27                    2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4 	Female 	43      Punjab       Amritsar             Amritsar Branch               Savings         18335.16            Transfer            Entertainment        16108.56          Virtual Card         Amritsar, Punjab            Mobile          0           Debt repayment            30                18                 30                    46</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-5---encode-categorical-features">Stage 5 - Encode Categorical Features<a href="#stage-5---encode-categorical-features" class="hash-link" aria-label="Direct link to Stage 5 - Encode Categorical Features" title="Direct link to Stage 5 - Encode Categorical Features">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Initializing the LabelEncoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">label_encoder = LabelEncoder()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for col in categorical_columns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df[col] = label_encoder.fit_transform(df[col])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-20">Output<a href="#output-20" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 	Customer_ID                             Customer_Name       Gender 	Age    State        City                 Bank_Branch                 Account_Type   Transaction_ID                          Transaction_Date   ...   Merchant_Category   Account_Balance   Transaction_Device   Transaction_Location          Device_Type   Is_Fraud   Transaction_Currency   Customer_Contact   Transaction_Description   Customer_Email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 	d5f6ec07-d69e-4f47-b9b4-7c58ff17c19e    Osha Tella          Male 	60     Kerala       Thiruvananthapuram   Thiruvananthapuram Branch   Savings        4fa3208f-9e23-42dc-b330-844829d0c12c    23-01-2025         ...   Restaurant          74557.27          Voice Assistant      Thiruvananthapuram, Kerala    POS           0          INR                    +9198579XXXXXX     Bitcoin transaction       oshaXXXXX@XXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 	7c14ad51-781a-4db9-b7bd-67439c175262    Hredhaan Khosla     Female 	51     Maharashtra  Nashik               Nashik Branch               Business       c9de0c06-2c4c-40a9-97ed-3c7b8f97c79c    11-01-2025         ...   Restaurant          74622.66          POS Mobile Device    Nashik, Maharashtra           Desktop       0          INR                    +9191074XXXXXX     Grocery delivery          hredhaanXXXX@XXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 	3a73a0e5-d4da-45aa-85f3-528413900a35    Ekani Nazareth      Male 	20     Bihar        Bhagalpur            Bhagalpur Branch            Savings        e41c55f9-c016-4ff3-872b-cae72467c75c    25-01-2025         ...   Groceries           66817.99          ATM                  Bhagalpur, Bihar              Desktop       0          INR                    +9197745XXXXXX     Mutual fund investment    ekaniXXX@XXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 	7902f4ef-9050-4a79-857d-9c2ea3181940    Yamini Ramachandran Female 	57     Tamil Nadu   Chennai              Chennai Branch              Business       7f7ee11b-ff2c-45a3-802a-49bc47c02ecb    19-01-2025         ...   Entertainment       58177.08          POS Mobile App       Chennai, Tamil Nadu           Mobile        0          INR                    +9195889XXXXXX     Food delivery             yaminiXXXXX@XXXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4 	3a4bba70-d9a9-4c5f-8b92-1735fd8c19e9    Kritika Rege        Female 	43     Punjab       Amritsar             Amritsar Branch             Savings        f8e6ac6f-81a1-4985-bf12-f60967d852ef    30-01-2025         ...   Entertainment       16108.56          Virtual Card         Amritsar, Punjab              Mobile        0          INR                    +9195316XXXXXX     Debt repayment            kritikaXXXX@XXXXXX.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5 rows × 24 columns</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.info()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-21">Output<a href="#output-21" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RangeIndex: 200000 entries, 0 to 199999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 19 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column                   Non-Null Count   Dtype</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------                   --------------   -----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   Gender                   200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   Age                      200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   State                    200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   City                     200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   Bank_Branch              200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   Account_Type             200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   Transaction_Amount       200000 non-null  float64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   Transaction_Type         200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   Merchant_Category        200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   Account_Balance          200000 non-null  float64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  Transaction_Device       200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  Transaction_Location     200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  Device_Type              200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  Is_Fraud                 200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  Transaction_Description  200000 non-null  int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  Transaction_Day          200000 non-null  int32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  Transaction_Hour         200000 non-null  int32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  Transaction_Minute       200000 non-null  int32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  Transaction_Second       200000 non-null  int32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: float64(2), int32(4), int64(13)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 25.9 MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.nunique()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-22">Output<a href="#output-22" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Gender                          2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Age                            53</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">State                          34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">City                          145</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bank_Branch                   145</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account_Type                    3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Amount         197978</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Type                5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Merchant_Category               6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account_Balance            197954</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Device             20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Location          148</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device_Type                     4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Is_Fraud                        2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Description       172</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Day                31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Hour               24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Minute             60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction_Second             60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtype: int64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-6---eda-after-label-encoder">Stage 6 - EDA after Label Encoder<a href="#stage-6---eda-after-label-encoder" class="hash-link" aria-label="Direct link to Stage 6 - EDA after Label Encoder" title="Direct link to Stage 6 - EDA after Label Encoder">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import seaborn as sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filter numerical columns with less than 20 unique values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numerical_features = df.select_dtypes(include=[&#x27;float64&#x27;, &#x27;int64&#x27;]).columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numerical_features = [col for col in numerical_features if df[col].nunique() &lt; 200]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set the number of charts per row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_cols = 2  # Number of charts per row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Calculate the number of rows needed based on the number of features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_rows = (len(numerical_features) + num_cols - 1) // num_cols  # This ensures enough rows are created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create a figure with the appropriate number of rows and columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(15, 5 * num_rows))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Plot the histograms for the filtered numerical columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i, feature in enumerate(numerical_features):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.subplot(num_rows, num_cols, i + 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sns.histplot(data=df, x=feature, hue=&#x27;Is_Fraud&#x27;, bins=30)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.title(f&#x27;{feature} Distribution by Churn Status&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.tight_layout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-23">Output<a href="#output-23" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/33-distribution.png" alt="33-distribution.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/34-distribution.png" alt="34-distribution.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/35-distribution.png" alt="35-distribution.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/36-distribution.png" alt="36-distribution.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/37-distribution.png" alt="37-distribution.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/38-distribution.png" alt="38-distribution.png">
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/39-distribution.png" alt="39-distribution.png">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-7---visualize-fraud-patterns-and-distribution-of-features">Stage 7 - Visualize Fraud Patterns and Distribution of Features<a href="#stage-7---visualize-fraud-patterns-and-distribution-of-features" class="hash-link" aria-label="Direct link to Stage 7 - Visualize Fraud Patterns and Distribution of Features" title="Direct link to Stage 7 - Visualize Fraud Patterns and Distribution of Features">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create a figure with 2 subplots in a horizontal row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fig, axes = plt.subplots(1, 2, figsize=(15, 6))  # 1 row, 2 columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># KDE plot for the &#x27;Is_Fraud&#x27; column (on the first subplot)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.kdeplot(df[&quot;Is_Fraud&quot;], fill=True, ax=axes[0])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes[0].set_title(&#x27;Target Variable Distribution&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Count plot for the &#x27;Is_Fraud&#x27; column (on the second subplot)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.countplot(x=&#x27;Is_Fraud&#x27;, data=df, ax=axes[1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes[1].set_title(&#x27;Fraudulent Transactions Count&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Adjust layout to prevent overlap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.tight_layout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Show the plot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-24">Output<a href="#output-24" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/40-plot-for-fraud.png" alt="40-plot-for-fraud.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Visualize fraud transactions based on &#x27;Transaction_Amount&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(12, 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.boxplot(x=&#x27;Is_Fraud&#x27;, y=&#x27;Transaction_Amount&#x27;, data=df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.title(&quot;Transaction Amount vs Fraud/Non-Fraud&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-25">Output<a href="#output-25" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/41-fraud-on-transaction-amount.png" alt="41-fraud-on-transaction-amount.png">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-8---plot-correlation-matrix-to-understand-feature-relationships">Stage 8 - Plot Correlation Matrix to Understand Feature Relationships<a href="#stage-8---plot-correlation-matrix-to-understand-feature-relationships" class="hash-link" aria-label="Direct link to Stage 8 - Plot Correlation Matrix to Understand Feature Relationships" title="Direct link to Stage 8 - Plot Correlation Matrix to Understand Feature Relationships">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(14, 10))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">correlation_matrix = df.corr()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.heatmap(correlation_matrix, annot=True, cmap=&#x27;coolwarm&#x27;, fmt=&quot;.2f&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.title(&quot;Correlation Matrix&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-26">Output<a href="#output-26" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/42-correlation-matrix.png" alt="42-correlation-matrix.png">
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Calculate correlation matrix for numerical columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">correlation_matrix = df.corr()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Extract correlation with &#x27;Exited&#x27; and drop &#x27;Exited&#x27; itself</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">correlation_price = correlation_matrix[&#x27;Is_Fraud&#x27;].sort_values(ascending=False).drop(&#x27;Is_Fraud&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Plot the heatmap for the correlation with &#x27;Exited&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(8, 5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns.heatmap(correlation_price.to_frame(), annot=True, cmap=&#x27;coolwarm&#x27;, fmt=&#x27;.2f&#x27;, linewidths=0.5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.title(&#x27;Correlation with Exited&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-27">Output<a href="#output-27" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/43-correlation-with-exited.png" alt="43-correlation-with-exited.png">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-9---feature-importance-using-random-forest">Stage 9 - Feature Importance using Random Forest<a href="#stage-9---feature-importance-using-random-forest" class="hash-link" aria-label="Direct link to Stage 9 - Feature Importance using Random Forest" title="Direct link to Stage 9 - Feature Importance using Random Forest">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rf = RandomForestClassifier(n_estimators=100, random_state=42)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X = df.drop(columns=[&#x27;Is_Fraud&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y = df[&#x27;Is_Fraud&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Shape for X Dataframe: &quot;, X.shape)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Columns for X Dataframe: &quot;, X.columns)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;-&quot;*50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Shape for y Dataframe: &quot;, y.shape)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-28">Output<a href="#output-28" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Shape for y Dataframe:  (200000,)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Train the model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rf.fit(X, y)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Get feature importances</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">feature_importances = pd.DataFrame(rf.feature_importances_, index=X.columns, columns=[&#x27;importance&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">feature_importances = feature_importances.sort_values(&#x27;importance&#x27;, ascending=False)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Plot feature importances</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(12, 8))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">feature_importances.head(20).plot(kind=&#x27;bar&#x27;, figsize=(10, 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.title(&quot;Top 20 Feature Importances&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-29">Output<a href="#output-29" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/44-top-20-feature-importances.png" alt="44-top-20-feature-importances.png">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-10---select-only-important-features">Stage 10 - Select Only Important Features<a href="#stage-10---select-only-important-features" class="hash-link" aria-label="Direct link to Stage 10 - Select Only Important Features" title="Direct link to Stage 10 - Select Only Important Features">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Select features with importance greater than a threshold (e.g., 0.01)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">important_features = feature_importances[feature_importances[&#x27;importance&#x27;] &gt; 0.01].index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X = df[important_features]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Shape for X Dataframe: &quot;, X.shape)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Columns for X Dataframe: &quot;, X.columns)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-30">Output<a href="#output-30" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Shape for X Dataframe:  (200000, 18)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Columns for X Dataframe:  Index([&#x27;Transaction_Amount&#x27;, &#x27;Account_Balance&#x27;, &#x27;Transaction_Description&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Second&#x27;, &#x27;Transaction_Minute&#x27;, &#x27;Age&#x27;, &#x27;Transaction_Day&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Transaction_Hour&#x27;, &#x27;Transaction_Device&#x27;, &#x27;Transaction_Location&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;State&#x27;, &#x27;City&#x27;, &#x27;Bank_Branch&#x27;, &#x27;Merchant_Category&#x27;, &#x27;Transaction_Type&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;Device_Type&#x27;, &#x27;Account_Type&#x27;, &#x27;Gender&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dtype=&#x27;object&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-11---perform-pca-principal-component-analysis">Stage 11 - Perform PCA (Principal Component Analysis)<a href="#stage-11---perform-pca-principal-component-analysis" class="hash-link" aria-label="Direct link to Stage 11 - Perform PCA (Principal Component Analysis)" title="Direct link to Stage 11 - Perform PCA (Principal Component Analysis)">​</a></h2>
<div class="language-# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   pca = PCA(n_components=2)  # Reducing to 2 components for visualization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   X_pca = pca.fit_transform(X)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Plot PCA results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.figure(figsize=(8, 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.scatter(X_pca[:, 0], X_pca[:, 1], c=y, cmap=&#x27;coolwarm&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.title(&quot;PCA of Important Features&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.xlabel(&quot;Principal Component 1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.ylabel(&quot;Principal Component 2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.colorbar(label=&#x27;Fraud (1) vs Non-Fraud (0)&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-31">Output<a href="#output-31" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/45-PCA-of-important-features.png" alt="45-PCA-of-important-features.png">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-12---train-test-split">Stage 12 - Train-test Split<a href="#stage-12---train-test-split" class="hash-link" aria-label="Direct link to Stage 12 - Train-test Split" title="Direct link to Stage 12 - Train-test Split">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-13---feature-scaling">Stage 13 - Feature Scaling<a href="#stage-13---feature-scaling" class="hash-link" aria-label="Direct link to Stage 13 - Feature Scaling" title="Direct link to Stage 13 - Feature Scaling">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scaler = StandardScaler()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train_scaled = scaler.fit_transform(X_train)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test_scaled = scaler.transform(X_test)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-14---model-training-and-evaluation">Stage 14 - Model Training and Evaluation<a href="#stage-14---model-training-and-evaluation" class="hash-link" aria-label="Direct link to Stage 14 - Model Training and Evaluation" title="Direct link to Stage 14 - Model Training and Evaluation">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Define models</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">models = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Logistic Regression&#x27;: LogisticRegression(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Decision Tree&#x27;: DecisionTreeClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Random Forest&#x27;: RandomForestClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Gradient Boosting&#x27;: GradientBoostingClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;XGBoost&#x27;: xgb.XGBClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;LightGBM&#x27;: lgb.LGBMClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;CatBoost&#x27;: cb.CatBoostClassifier(silent=True),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;AdaBoost&#x27;: AdaBoostClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Bagging&#x27;: BaggingClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;KNN&#x27;: KNeighborsClassifier()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # &#x27;SVM (RBF)&#x27;: SVC(kernel=&#x27;rbf&#x27;, probability=True),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # &#x27;SVM (Linear)&#x27;: LinearSVC(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # &#x27;GaussianNB&#x27;: GaussianNB()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # &#x27;LDA&#x27;: LDA(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # &#x27;QDA&#x27;: QuadraticDiscriminantAnalysis(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # &#x27;Ridge Classifier&#x27;: RidgeClassifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Define reduced parameter grids</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">param_grids = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Logistic Regression&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;C&#x27;: [0.1, 1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;solver&#x27;: [&#x27;liblinear&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;penalty&#x27;: [&#x27;l2&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Decision Tree&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;max_depth&#x27;: [5, 10],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;min_samples_split&#x27;: [2, 5],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;min_samples_leaf&#x27;: [1, 2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Random Forest&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_estimators&#x27;: [50, 100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;max_depth&#x27;: [10],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;min_samples_split&#x27;: [2],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;min_samples_leaf&#x27;: [1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Gradient Boosting&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_estimators&#x27;: [100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;learning_rate&#x27;: [0.1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;max_depth&#x27;: [5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;XGBoost&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_estimators&#x27;: [100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;learning_rate&#x27;: [0.1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;max_depth&#x27;: [5],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;subsample&#x27;: [0.8, 1.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;SVM (RBF)&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;C&#x27;: [1, 10],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;gamma&#x27;: [&#x27;scale&#x27;, &#x27;auto&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;SVM (Linear)&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;C&#x27;: [1, 10],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;LightGBM&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_estimators&#x27;: [100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;learning_rate&#x27;: [0.1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;max_depth&#x27;: [3, 5],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;CatBoost&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;iterations&#x27;: [100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;learning_rate&#x27;: [0.1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;depth&#x27;: [3, 5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;KNN&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_neighbors&#x27;: [3],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;weights&#x27;: [&#x27;uniform&#x27;, &#x27;distance&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;AdaBoost&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_estimators&#x27;: [100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;learning_rate&#x27;: [0.01, 0.1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Bagging&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;n_estimators&#x27;: [100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;max_samples&#x27;: [0.8, 1.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;LDA&#x27;: {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;QDA&#x27;: {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;Ridge Classifier&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;alpha&#x27;: [0.1, 1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;GaussianNB&#x27;: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Initialize an empty dictionary to store results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model_results = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Handle class imbalance by computing class weights for each model that supports it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class_weights = compute_class_weight(&#x27;balanced&#x27;, classes=np.array([0, 1]), y=y_train)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class_weight_dict = {0: class_weights[0], 1: class_weights[1]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;class_weight_dict: &quot;, class_weight_dict)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Handle SMOTE for class imbalance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smote = SMOTE(sampling_strategy=&#x27;auto&#x27;, random_state=42)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train_smote, y_train_smote = smote.fit_resample(X_train_scaled, y_train)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Evaluate models with GridSearchCV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for model_name, model in models.items():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Training model with GridSearchCV: {model_name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Get the parameter grid for the model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    param_grid = param_grids[model_name]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Modify model to include class weights where applicable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if model_name in [&#x27;Logistic Regression&#x27;, &#x27;Random Forest&#x27;, &#x27;SVM (RBF)&#x27;, &#x27;SVM (Linear)&#x27;]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Assign class weights for models that support it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if model_name == &#x27;Logistic Regression&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            model = LogisticRegression(class_weight=&#x27;balanced&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        elif model_name == &#x27;Random Forest&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            model = RandomForestClassifier(class_weight=&#x27;balanced&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        elif model_name in [&#x27;SVM (RBF)&#x27;, &#x27;SVM (Linear)&#x27;]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            model = SVC(probability=True, class_weight=&#x27;balanced&#x27;) if model_name == &#x27;SVM (RBF)&#x27; else LinearSVC(class_weight=&#x27;balanced&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Perform GridSearchCV with parallelism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grid_search = GridSearchCV(estimator=model, param_grid=param_grid, cv=3, n_jobs=-1, verbose=2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Fit the model with the best parameters using the resampled data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grid_search.fit(X_train_smote, y_train_smote)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Get the best model and its parameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    best_model = grid_search.best_estimator_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Best parameters for {model_name}: {grid_search.best_params_}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Predict on both train and test sets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y_train_pred = best_model.predict(X_train_smote)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y_test_pred = best_model.predict(X_test_scaled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Store the results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model_results[model_name] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;train_accuracy&#x27;: best_model.score(X_train_smote, y_train_smote),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;test_accuracy&#x27;: best_model.score(X_test_scaled, y_test),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;y_test&#x27;: y_test,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;y_test_pred&#x27;: y_test_pred,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;classification_report&#x27;: classification_report(y_test, y_test_pred),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;roc_auc&#x27;: roc_auc_score(y_test, best_model.predict_proba(X_test_scaled)[:, 1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Print results after all models are evaluated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;\nModel Evaluation Results:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Model: {model_results[model_name]}\n&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Train Accuracy: {model_results[model_name][&#x27;train_accuracy&#x27;]:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Test Accuracy: {model_results[model_name][&#x27;test_accuracy&#x27;]:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;ROC AUC: {model_results[model_name][&#x27;roc_auc&#x27;]:.4f}\n&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Classification Report:\n{model_results[model_name][&#x27;classification_report&#x27;]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;-&quot; * 80)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-32">Output<a href="#output-32" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class_weight_dict:  {0: 0.5264647235731161, 1: 9.946537361680965}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: Logistic Regression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for Logistic Regression: {&#x27;C&#x27;: 0.1, &#x27;penalty&#x27;: &#x27;l2&#x27;, &#x27;solver&#x27;: &#x27;liblinear&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.5110919536447811, &#x27;test_accuracy&#x27;: 0.509575, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 1, 1, ..., 1, 1, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      0.51      0.66     37955\n           1       0.05      0.50      0.09      2045\n\n    accuracy                           0.51     40000\n   macro avg       0.50      0.50      0.38     40000\nweighted avg       0.90      0.51      0.63     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.49595028728847923}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.5111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.5096</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.4960</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      0.51      0.66     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.05      0.50      0.09      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.51     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.50      0.50      0.38     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.51      0.63     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: Decision Tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 8 candidates, totalling 24 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for Decision Tree: {&#x27;max_depth&#x27;: 10, &#x27;min_samples_leaf&#x27;: 2, &#x27;min_samples_split&#x27;: 5}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.8582065979191482, &#x27;test_accuracy&#x27;: 0.946825, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      1.00      0.97     37955\n           1       0.02      0.00      0.00      2045\n\n    accuracy                           0.95     40000\n   macro avg       0.49      0.50      0.49     40000\nweighted avg       0.90      0.95      0.92     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.4977343714519736}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.8582</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.9468</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.4977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      1.00      0.97     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.02      0.00      0.00      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.95     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.49      0.50      0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.95      0.92     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: Random Forest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for Random Forest: {&#x27;max_depth&#x27;: 10, &#x27;min_samples_leaf&#x27;: 1, &#x27;min_samples_split&#x27;: 2, &#x27;n_estimators&#x27;: 50}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.8498127759826793, &#x27;test_accuracy&#x27;: 0.85335, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      0.89      0.92     37955\n           1       0.05      0.11      0.07      2045\n\n    accuracy                           0.85     40000\n   macro avg       0.50      0.50      0.50     40000\nweighted avg       0.90      0.85      0.88     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.5063503975722118}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.8498</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.8534</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.5064</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      0.89      0.92     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.05      0.11      0.07      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.85     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.50      0.50      0.50     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.85      0.88     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: Gradient Boosting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 1 candidates, totalling 3 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=1, min_samples_split=2; total time=   1.8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=1, min_samples_split=2; total time=   2.0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=2, min_samples_split=5; total time=   1.8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=2, min_samples_split=5; total time=   1.9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=1, min_samples_split=5; total time=   1.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=1, min_samples_split=5; total time=   2.0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=1, min_samples_split=2; total time=   1.9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ................C=0.1, penalty=l2, solver=liblinear; total time=   0.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=2, min_samples_split=5; total time=   2.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ..................C=1, penalty=l2, solver=liblinear; total time=   0.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=2, min_samples_split=5; total time=   2.9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=2, min_samples_split=5; total time=   2.5s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2; total time=   2.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=5; total time=   2.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=2, min_samples_split=2; total time=   2.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=5; total time=   2.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=5; total time=   2.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2; total time=   2.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=2, min_samples_split=2; total time=   2.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2; total time=   2.8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=2, min_samples_split=2; total time=   2.8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ..................C=1, penalty=l2, solver=liblinear; total time=   0.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2, n_estimators=50; total time=  19.5s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ................C=0.1, penalty=l2, solver=liblinear; total time=   0.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2, n_estimators=50; total time=  19.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ................C=0.1, penalty=l2, solver=liblinear; total time=   0.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2, n_estimators=50; total time=  19.8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=2, min_samples_split=2; total time=   1.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2, n_estimators=100; total time=  37.4s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=1, min_samples_split=5; total time=   1.6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2, n_estimators=100; total time=  37.4s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ..................C=1, penalty=l2, solver=liblinear; total time=   0.8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=10, min_samples_leaf=1, min_samples_split=2, n_estimators=100; total time=  38.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for Gradient Boosting: {&#x27;learning_rate&#x27;: 0.1, &#x27;max_depth&#x27;: 5, &#x27;n_estimators&#x27;: 100}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.9527168870140895, &#x27;test_accuracy&#x27;: 0.948875, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      1.00      0.97     37955\n           1       0.00      0.00      0.00      2045\n\n    accuracy                           0.95     40000\n   macro avg       0.47      0.50      0.49     40000\nweighted avg       0.90      0.95      0.92     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.5045642649141516}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.9527</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.9489</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.5046</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      1.00      0.97     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.00      0.00      0.00      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.95     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.47      0.50      0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.95      0.92     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: XGBoost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for XGBoost: {&#x27;learning_rate&#x27;: 0.1, &#x27;max_depth&#x27;: 5, &#x27;n_estimators&#x27;: 100, &#x27;subsample&#x27;: 1.0}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.9471528129668262, &#x27;test_accuracy&#x27;: 0.948875, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      1.00      0.97     37955\n           1       0.00      0.00      0.00      2045\n\n    accuracy                           0.95     40000\n   macro avg       0.47      0.50      0.49     40000\nweighted avg       0.90      0.95      0.92     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.49996872502793327}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.9472</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.9489</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.5000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      1.00      0.97     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.00      0.00      0.00      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.95     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.47      0.50      0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.95      0.92     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: LightGBM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] Number of positive: 151957, number of negative: 151957</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.002153 seconds.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You can set `force_row_wise=true` to remove the overhead.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">And if memory is not enough, you can set `force_col_wise=true`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] Total Bins 4584</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] Number of data points in the train set: 303914, number of used features: 18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.500000 -&gt; initscore=0.000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for LightGBM: {&#x27;learning_rate&#x27;: 0.1, &#x27;max_depth&#x27;: 5, &#x27;n_estimators&#x27;: 100}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.9520357732779668, &#x27;test_accuracy&#x27;: 0.948875, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      1.00      0.97     37955\n           1       0.00      0.00      0.00      2045\n\n    accuracy                           0.95     40000\n   macro avg       0.47      0.50      0.49     40000\nweighted avg       0.90      0.95      0.92     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.4997815261220097}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.9520</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.9489</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.4998</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      1.00      0.97     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.00      0.00      0.00      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.95     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.47      0.50      0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.95      0.92     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: CatBoost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for CatBoost: {&#x27;depth&#x27;: 5, &#x27;iterations&#x27;: 100, &#x27;learning_rate&#x27;: 0.1}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.9496864244490217, &#x27;test_accuracy&#x27;: 0.948875, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      1.00      0.97     37955\n           1       0.00      0.00      0.00      2045\n\n    accuracy                           0.95     40000\n   macro avg       0.47      0.50      0.49     40000\nweighted avg       0.90      0.95      0.92     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.49888715854800386}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.9497</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.9489</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.4989</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      1.00      0.97     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.00      0.00      0.00      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.95     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.47      0.50      0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.95      0.92     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: AdaBoost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=2, min_samples_split=2; total time=   1.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...learning_rate=0.1, max_depth=5, n_estimators=100; total time= 2.2min</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.8; total time=   1.2s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=2, min_samples_split=2; total time=   1.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...learning_rate=0.1, max_depth=5, n_estimators=100; total time= 2.3min</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.8; total time=   1.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END max_depth=5, min_samples_leaf=2, min_samples_split=5; total time=   1.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...learning_rate=0.1, max_depth=5, n_estimators=100; total time= 2.3min</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.8; total time=   1.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=1.0; total time=   1.2s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=1.0; total time=   1.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=1.0; total time=   1.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for AdaBoost: {&#x27;learning_rate&#x27;: 0.1, &#x27;n_estimators&#x27;: 100}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.629306316918602, &#x27;test_accuracy&#x27;: 0.486475, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 1, 1, 1]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      0.48      0.64     37955\n           1       0.05      0.52      0.09      2045\n\n    accuracy                           0.49     40000\n   macro avg       0.50      0.50      0.37     40000\nweighted avg       0.90      0.49      0.61     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.5060679179017489}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 0.6293</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.4865</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.5061</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      0.48      0.64     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.05      0.52      0.09      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.50      0.50      0.37     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.49      0.61     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: Bagging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END .........depth=3, iterations=100, learning_rate=0.1; total time=   2.1s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END .........depth=3, iterations=100, learning_rate=0.1; total time=   2.1s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END .........depth=3, iterations=100, learning_rate=0.1; total time=   2.2s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END .........depth=5, iterations=100, learning_rate=0.1; total time=   2.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END .........depth=5, iterations=100, learning_rate=0.1; total time=   2.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END .........depth=5, iterations=100, learning_rate=0.1; total time=   2.3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...............learning_rate=0.01, n_estimators=100; total time=  33.5s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ................learning_rate=0.1, n_estimators=100; total time=  33.7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ................learning_rate=0.1, n_estimators=100; total time=  33.9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...............learning_rate=0.01, n_estimators=100; total time=  34.0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...............learning_rate=0.01, n_estimators=100; total time=  34.9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ................learning_rate=0.1, n_estimators=100; total time=  35.0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] Number of positive: 101305, number of negative: 101305</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.157509 seconds.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### ----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### ---- more details - see notebook for this cell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### -----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[LightGBM] [Warning] No further splits with positive gain, best gain: -inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ...learning_rate=0.1, max_depth=5, n_estimators=100; total time= 3.4min</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CV] END ..................max_samples=1.0, n_estimators=100; total time= 3.4min</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 0.999990128786433, &#x27;test_accuracy&#x27;: 0.948725, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 0, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      1.00      0.97     37955\n           1       0.00      0.00      0.00      2045\n\n    accuracy                           0.95     40000\n   macro avg       0.47      0.50      0.49     40000\nweighted avg       0.90      0.95      0.92     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.5051717981562905}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 1.0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.9487</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.5052</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      1.00      0.97     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.00      0.00      0.00      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.95     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.47      0.50      0.49     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.95      0.92     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Training model with GridSearchCV: KNN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fitting 3 folds for each of 2 candidates, totalling 6 fits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best parameters for KNN: {&#x27;n_neighbors&#x27;: 3, &#x27;weights&#x27;: &#x27;distance&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model Evaluation Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model: {&#x27;train_accuracy&#x27;: 1.0, &#x27;test_accuracy&#x27;: 0.7367, &#x27;y_test&#x27;: 119737    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">72272     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">158154    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">65426     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30074     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4174      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91537     0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156449    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">184376    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6584      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Is_Fraud, Length: 40000, dtype: int64, &#x27;y_test_pred&#x27;: array([0, 0, 1, ..., 0, 0, 0]), &#x27;classification_report&#x27;: &#x27;              precision    recall  f1-score   support\n\n           0       0.95      0.76      0.85     37955\n           1       0.05      0.23      0.08      2045\n\n    accuracy                           0.74     40000\n   macro avg       0.50      0.50      0.46     40000\nweighted avg       0.90      0.74      0.81     40000\n&#x27;, &#x27;roc_auc&#x27;: 0.4954215631108644}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train Accuracy: 1.0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Accuracy: 0.7367</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROC AUC: 0.4954</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Classification Report:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              precision    recall  f1-score   support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0       0.95      0.76      0.85     37955</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1       0.05      0.23      0.08      2045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy                           0.74     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   macro avg       0.50      0.50      0.46     40000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weighted avg       0.90      0.74      0.81     40000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-15---displaying-evaluation-results-for-all-models">Stage 15 - Displaying Evaluation Results for All Models<a href="#stage-15---displaying-evaluation-results-for-all-models" class="hash-link" aria-label="Direct link to Stage 15 - Displaying Evaluation Results for All Models" title="Direct link to Stage 15 - Displaying Evaluation Results for All Models">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># # Print results after all models are evaluated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(&quot;\nModel Evaluation Results:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(f&quot;Model: {model_results[model_name]}\n&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(f&quot;Train Accuracy: {model_results[model_name][&#x27;train_accuracy&#x27;]:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(f&quot;Test Accuracy: {model_results[model_name][&#x27;test_accuracy&#x27;]:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(f&quot;ROC AUC: {model_results[model_name][&#x27;roc_auc&#x27;]:.4f}\n&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(f&quot;Classification Report:\n{model_results[model_name][&#x27;classification_report&#x27;]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(&quot;-&quot; * 80)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-16---plotting-the-train-vs-test-accuracy-chart">Stage 16 - Plotting the Train Vs Test Accuracy Chart<a href="#stage-16---plotting-the-train-vs-test-accuracy-chart" class="hash-link" aria-label="Direct link to Stage 16 - Plotting the Train Vs Test Accuracy Chart" title="Direct link to Stage 16 - Plotting the Train Vs Test Accuracy Chart">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import seaborn as sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.metrics import confusion_matrix, classification_report, roc_curve, auc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Initialize a list to store results for all models</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results_list = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Iterate through the models to collect results and plot confusion matrix and ROC curve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for model_name, model in model_results.items():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Extract the predicted values and actual values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y_test_pred = model[&#x27;y_test_pred&#x27;]  # Use the predicted labels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y_test = model[&#x27;y_test&#x27;]  # Actual true labels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Extract metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    train_accuracy = model[&#x27;train_accuracy&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_accuracy = model[&#x27;test_accuracy&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    roc_auc = model[&#x27;roc_auc&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Classification Report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clf_report = classification_report(y_test, y_test_pred)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Print the model name followed by its evaluation metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;-&quot; * 40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Model: {model_name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;-&quot; * 40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Train Accuracy: {train_accuracy:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Test Accuracy: {test_accuracy:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;ROC AUC: {roc_auc:.4f}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;Classification Report:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(clf_report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;-&quot; * 80)  # Separator line for clarity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Generate confusion matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cm = confusion_matrix(y_test, y_test_pred)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ROC Curve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fpr, tpr, _ = roc_curve(y_test, y_test_pred)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    roc_auc_value = auc(fpr, tpr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Create subplots: 1 row, 2 columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))  # Width, Height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Plot ROC Curve on the first subplot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.plot(fpr, tpr, color=&#x27;b&#x27;, lw=2, label=f&#x27;ROC curve (area = {roc_auc_value:.2f})&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.plot([0, 1], [0, 1], color=&#x27;gray&#x27;, linestyle=&#x27;--&#x27;)  # Random classifier line</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.set_xlim([0.0, 1.0])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.set_ylim([0.0, 1.05])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.set_xlabel(&#x27;False Positive Rate&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.set_ylabel(&#x27;True Positive Rate&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.set_title(f&#x27;ROC Curve for {model_name}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax1.legend(loc=&#x27;lower right&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Plot Confusion Matrix on the second subplot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sns.heatmap(cm, annot=True, fmt=&#x27;d&#x27;, cmap=&#x27;Blues&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                xticklabels=[&#x27;Predicted Negative&#x27;, &#x27;Predicted Positive&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                yticklabels=[&#x27;Actual Negative&#x27;, &#x27;Actual Positive&#x27;], ax=ax2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax2.set_title(f&#x27;Confusion Matrix for {model_name}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax2.set_xlabel(&#x27;Predicted&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ax2.set_ylabel(&#x27;Actual&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Show both plots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.tight_layout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt.show()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Append the results to the list for the DataFrame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    results_list.append({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;Model&#x27;: model_name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;Train Accuracy&#x27;: f&quot;{train_accuracy:.4f}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;Test Accuracy&#x27;: f&quot;{test_accuracy:.4f}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;ROC AUC&#x27;: f&quot;{roc_auc:.4f}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;Classification Report&#x27;: clf_report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Convert results into a DataFrame for better presentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results_df = pd.DataFrame(results_list)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Print the summary of results in a tabular format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(&quot;\nSummary of Model Evaluation Results:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># print(results_df.to_string(index=False))  # Display as a pretty table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;-&quot; * 80)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-33">Output<a href="#output-33" class="hash-link" aria-label="Direct link to Output" title="Direct link to Output">​</a></h4>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/46-logistic-regression.png" alt="46-logistic-regression.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/47-decision-tree.png" alt="47-decision-tree.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/48-random-forest.png" alt="48-random-forest.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/49-gradient-boosting.png" alt="49-gradient-boosting.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/50-xgboost.png" alt="50-xgboost.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/51-ligthgbm.png" alt="51-ligthgbm.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/52-catboost.png" alt="52-catboost.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/53-adaboost.png" alt="53-adaboost.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/54-bagging.png" alt="54-bagging.png">
<br>
<br>
<img src="/img/ai/machine-learning/fraud-detection/Bank-Transaction-Fraud-Detection-01/55-knn.png" alt="55-knn.png">
<br>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stage-17---final-conclusion">Stage 17 - Final Conclusion<a href="#stage-17---final-conclusion" class="hash-link" aria-label="Direct link to Stage 17 - Final Conclusion" title="Direct link to Stage 17 - Final Conclusion">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion:<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion:" title="Direct link to Conclusion:">​</a></h3>
<ul>
<li>
<p>High Test Accuracy: The model achieved a high test accuracy, indicating that it correctly predicted most instances in the test set. This is a promising result for the overall performance of the model.</p>
</li>
<li>
<p>ROC AUC: The ROC AUC is nearly 0.5, which is close to random guessing. This suggests that the model struggles to distinguish between the two classes effectively. The low ROC AUC indicates poor discriminative power, especially for class 1.</p>
</li>
<li>
<p>Class Imbalance: The classification report highlights a significant class imbalance.</p>
<ul>
<li>Class 0 (majority class) has a high precision of 0.95 and recall of 1.00, with an F1-score of 0.97, indicating that the model performs very well on class 0.</li>
<li>Class 1 (minority class) has very low precision (0.02) and recall (0.00), with an F1-score of 0.00, indicating that the model struggles severely to identify the minority class (class 1).</li>
</ul>
</li>
<li>
<p>Impact of Class Imbalance: The poor performance on class 1 suggests that the model may be biased towards predicting the majority class (class 0), and thus failing to identify the minority class. This is supported by the low recall and precision for class 1.</p>
</li>
<li>
<p>Model Improvement Suggestions:</p>
<ul>
<li>Address Class Imbalance: Techniques such as resampling (SMOTE), class weights adjustment, or using more balanced metrics like F1-score for class 1 can help improve the model&#x27;s ability to detect the minority class.</li>
<li>Model Tuning: Exploring other models or hyperparameters to better balance accuracy across both classes may improve performance.</li>
</ul>
</li>
<li>
<p>Final Remarks: While the model shows strong performance in terms of overall accuracy, it is heavily biased towards the majority class, which makes it unreliable for detecting the minority class. Addressing the class imbalance should be a priority for improving model performance in real-world scenarios.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="final-remarks">Final Remarks:<a href="#final-remarks" class="hash-link" aria-label="Direct link to Final Remarks:" title="Direct link to Final Remarks:">​</a></h3>
<ul>
<li>
<p>The model demonstrates strong overall accuracy, indicating its ability to correctly predict the majority of instances within the dataset.</p>
</li>
<li>
<p>There is a noticeable discrepancy between training and testing accuracy, which may suggest some degree of overfitting, although the difference is not extreme.</p>
</li>
<li>
<p>The ROC AUC score is close to random guessing, indicating that the model struggles with distinguishing between the two classes, especially for the minority class.</p>
</li>
<li>
<p>Class imbalance is a significant issue, as the model shows excellent performance on the majority class but fails to effectively identify the minority class.</p>
</li>
<li>
<p>Precision and recall for the majority class are very high, showcasing that the model can accurately predict this class without many false positives or negatives.</p>
</li>
<li>
<p>The performance for the minority class is poor, with the model having difficulty detecting and correctly predicting instances of this class.</p>
</li>
<li>
<p>The model&#x27;s inability to perform well on the minority class suggests a bias toward the majority class, which reduces its overall usefulness in cases where detecting the minority class is important.</p>
</li>
<li>
<p>There is an imbalance between the precision and recall of the two classes, with the model being much more sensitive to the majority class.</p>
</li>
<li>
<p>Improvements to the model should focus on addressing class imbalance, such as through resampling techniques, class weighting, or exploring alternative models that are more adept at handling skewed distributions.</p>
</li>
<li>
<p>The current model, while performing well on the majority class, needs further optimization and tuning to ensure it can reliably detect the minority class and be more robust across all categories.</p>
</li>
</ul>
<br>
<hr>
<p><em><strong>On the base + sources</strong></em>:<br>
<a href="https://www.kaggle.com/code/marusagar/bank-transaction-fraud-detection-accuracy-95" target="_blank" rel="noopener noreferrer"><em><strong>Bank Transaction Fraud Detection (Accuracy: 95%)</strong></em></a> <br></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/artificial-intelligence/machine-learning/examples/fraud-detection/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Fraud Detection</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/artificial-intelligence/machine-learning/examples/health/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Health</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#problem-statement" class="table-of-contents__link toc-highlight">Problem Statement</a></li><li><a href="#objectives-for-bank-transaction-fraud-detection" class="table-of-contents__link toc-highlight">Objectives for Bank Transaction Fraud Detection</a></li><li><a href="#technologies-used" class="table-of-contents__link toc-highlight">Technologies Used</a></li><li><a href="#jupyter-notebook" class="table-of-contents__link toc-highlight">Jupyter Notebook</a></li><li><a href="#stage-1---importing-libraries" class="table-of-contents__link toc-highlight">Stage 1 - Importing Libraries</a></li><li><a href="#stage-2---data-preprocessing" class="table-of-contents__link toc-highlight">Stage 2 - Data Preprocessing</a></li><li><a href="#stage-3---exploratory-data-analysis-eda" class="table-of-contents__link toc-highlight">Stage 3 - Exploratory Data Analysis (EDA)</a><ul><li><a href="#eda-for-numerical-columns" class="table-of-contents__link toc-highlight">EDA for Numerical Columns</a></li><li><a href="#eda-for-categorical-columns" class="table-of-contents__link toc-highlight">EDA for Categorical Columns</a></li></ul></li><li><a href="#stage-4---convert-date-time-columns-to-numerical-columns" class="table-of-contents__link toc-highlight">Stage 4 - Convert Date Time Columns to Numerical Columns</a></li><li><a href="#stage-5---encode-categorical-features" class="table-of-contents__link toc-highlight">Stage 5 - Encode Categorical Features</a></li><li><a href="#stage-6---eda-after-label-encoder" class="table-of-contents__link toc-highlight">Stage 6 - EDA after Label Encoder</a></li><li><a href="#stage-7---visualize-fraud-patterns-and-distribution-of-features" class="table-of-contents__link toc-highlight">Stage 7 - Visualize Fraud Patterns and Distribution of Features</a></li><li><a href="#stage-8---plot-correlation-matrix-to-understand-feature-relationships" class="table-of-contents__link toc-highlight">Stage 8 - Plot Correlation Matrix to Understand Feature Relationships</a></li><li><a href="#stage-9---feature-importance-using-random-forest" class="table-of-contents__link toc-highlight">Stage 9 - Feature Importance using Random Forest</a></li><li><a href="#stage-10---select-only-important-features" class="table-of-contents__link toc-highlight">Stage 10 - Select Only Important Features</a></li><li><a href="#stage-11---perform-pca-principal-component-analysis" class="table-of-contents__link toc-highlight">Stage 11 - Perform PCA (Principal Component Analysis)</a></li><li><a href="#stage-12---train-test-split" class="table-of-contents__link toc-highlight">Stage 12 - Train-test Split</a></li><li><a href="#stage-13---feature-scaling" class="table-of-contents__link toc-highlight">Stage 13 - Feature Scaling</a></li><li><a href="#stage-14---model-training-and-evaluation" class="table-of-contents__link toc-highlight">Stage 14 - Model Training and Evaluation</a></li><li><a href="#stage-15---displaying-evaluation-results-for-all-models" class="table-of-contents__link toc-highlight">Stage 15 - Displaying Evaluation Results for All Models</a></li><li><a href="#stage-16---plotting-the-train-vs-test-accuracy-chart" class="table-of-contents__link toc-highlight">Stage 16 - Plotting the Train Vs Test Accuracy Chart</a></li><li><a href="#stage-17---final-conclusion" class="table-of-contents__link toc-highlight">Stage 17 - Final Conclusion</a><ul><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion:</a></li><li><a href="#final-remarks" class="table-of-contents__link toc-highlight">Final Remarks:</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://netty.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Netty Project<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/reactive-streams/reactive-streams-jvm?tab=readme-ov-file" target="_blank" rel="noopener noreferrer" class="footer__link-item">reactive-streams-jvm <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://pages.github.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Pages<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">License</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-sa.png" alt="CC BY-SA License" height="40px" width="114px"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 jreact.com</div></div></div></footer></div>
</body>
</html>