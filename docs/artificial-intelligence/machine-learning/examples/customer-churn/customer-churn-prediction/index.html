<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-artificial-intelligence/machine-learning/examples/customer-churn/customer-churn-prediction" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Customer Churn Prediction | Machine Learning &amp; Big Data &amp; Reactive Programming</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/customer-churn/customer-churn-prediction"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Customer Churn Prediction | Machine Learning &amp; Big Data &amp; Reactive Programming"><meta data-rh="true" name="description" content="Description"><meta data-rh="true" property="og:description" content="Description"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/customer-churn/customer-churn-prediction"><link data-rh="true" rel="alternate" href="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/customer-churn/customer-churn-prediction" hreflang="en"><link data-rh="true" rel="alternate" href="https://zbciok.github.io/docs/artificial-intelligence/machine-learning/examples/customer-churn/customer-churn-prediction" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Machine Learning &amp; Big Data &amp; Reactive Programming RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Machine Learning &amp; Big Data &amp; Reactive Programming Atom Feed"><link rel="stylesheet" href="/assets/css/styles.4b0135be.css">
<script src="/assets/js/runtime~main.91423f6c.js" defer="defer"></script>
<script src="/assets/js/main.f971ea5f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="RP" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.ico" alt="RP" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://jreact.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">jreact.com<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/streams">Streams</a><button aria-label="Expand sidebar category &#x27;Streams&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/project-reactor">Project Reactor</a><button aria-label="Expand sidebar category &#x27;Project Reactor&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/smallrye-mutiny">SmallRye Mutiny</a><button aria-label="Expand sidebar category &#x27;SmallRye Mutiny&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vertx">VERT.X</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/aws">AWS</a><button aria-label="Expand sidebar category &#x27;AWS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/quarkus">Quarkus</a><button aria-label="Expand sidebar category &#x27;Quarkus&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/spring">Spring</a><button aria-label="Expand sidebar category &#x27;Spring&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/messaging-1">Messaging</a><button aria-label="Expand sidebar category &#x27;Messaging&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/apache-flink">Apache Flink</a><button aria-label="Expand sidebar category &#x27;Apache Flink&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/apache-hadoop">Apache Hadoop</a><button aria-label="Expand sidebar category &#x27;Apache Hadoop&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/apache-spark">Apache Spark</a><button aria-label="Expand sidebar category &#x27;Apache Spark&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/artificial-intelligence/">Artificial Intelligence</a><button aria-label="Collapse sidebar category &#x27;Artificial Intelligence&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/artificial-intelligence/machine-learning/">Machine Learning (ML)</a><button aria-label="Collapse sidebar category &#x27;Machine Learning (ML)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/machine-learning/ml-models">ML Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/machine-learning/principal-component-analysis-PCA">Principal Component Analysis (PCA)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/evaluation/">Model Evaluation</a><button aria-label="Expand sidebar category &#x27;Model Evaluation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/classification/">Classification</a><button aria-label="Expand sidebar category &#x27;Classification&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/clustering/">Clustering</a><button aria-label="Expand sidebar category &#x27;Clustering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/features/">Features</a><button aria-label="Expand sidebar category &#x27;Features&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/machine-learning/tools-for-integrating-ml-into-business-application/">Tools for integrating ML into business application</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/">Examples</a><button aria-label="Collapse sidebar category &#x27;Examples&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/customer-churn/">Customer Churn</a><button aria-label="Collapse sidebar category &#x27;Customer Churn&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/customer-churn/customer-churn-prediction">Customer Churn Prediction</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/stock-price-prediction/">Stock Price Prediction</a><button aria-label="Expand sidebar category &#x27;Stock Price Prediction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/fraud-detection/">Fraud Detection</a><button aria-label="Expand sidebar category &#x27;Fraud Detection&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/artificial-intelligence/machine-learning/examples/health/">Health</a><button aria-label="Expand sidebar category &#x27;Health&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/apache-ai-projects">Apache AI Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/artificial-intelligence/references">References</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/auxiliary-software">Auxiliary</a><button aria-label="Expand sidebar category &#x27;Auxiliary&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/"><span itemprop="name">Artificial Intelligence</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/machine-learning/"><span itemprop="name">Machine Learning (ML)</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/machine-learning/examples/"><span itemprop="name">Examples</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/artificial-intelligence/machine-learning/examples/customer-churn/"><span itemprop="name">Customer Churn</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Customer Churn Prediction</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Customer Churn Prediction</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h2>
<p>In this notebook/example, we’ll explore how to use PySpark to analyze and model customer churn data. The goal is to predict which customers are at risk of leaving a telecom company—so we can help businesses take action before it&#x27;s too late!</p>
<p>We&#x27;re going to:</p>
<ul>
<li>Load and understand the dataset</li>
<li>Prepare the data for modeling</li>
<li>Train a machine learning model</li>
<li>Evaluate its performance</li>
</ul>
<p>By the end, we’ll have a working churn prediction pipeline using PySpark.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-of-the-example">Code of the Example<a href="#code-of-the-example" class="hash-link" aria-label="Direct link to Code of the Example" title="Direct link to Code of the Example">​</a></h2>
<ul>
<li><a href="https://www.kaggle.com/code/samanehshahpuori/customer-churn-prediction-pyspark/notebook" target="_blank" rel="noopener noreferrer"><em><strong>Kaggle: Customer Churn Prediction</strong></em></a> <br>
or</li>
<li>locally<!-- -->
<ul>
<li><a href="https://github.com/ZbCiok/zjc-examples/blob/main/ai/ml/examples/customer-churn/customer-churn-prediction/WA_Fn-UseC_-Telco-Customer-Churn.csv" target="_blank" rel="noopener noreferrer"><em><strong>Download dataset</strong></em></a></li>
<li><a href="https://github.com/ZbCiok/zjc-examples/blob/main/ai/ml/examples/customer-churn/customer-churn-prediction/Customer-Churn-Prediction.ipynb" target="_blank" rel="noopener noreferrer"><em><strong>Download the Example Notebook</strong></em></a></li>
<li><a href="https://jupyter.org/install" target="_blank" rel="noopener noreferrer"><em><strong>Install jupyter notebook:</strong></em></a><br>
<ul>
<li><em><strong><code>pip install notebook</code></strong></em></li>
<li>Run the notebook:</li>
<li><em><strong><code>jupyter notebook</code></strong></em></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jupyter-notebook">Jupyter Notebook<a href="#jupyter-notebook" class="hash-link" aria-label="Direct link to Jupyter Notebook" title="Direct link to Jupyter Notebook">​</a></h2>
<ul>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-pyspark-modules--sparksession">Install PySpark, Modules &amp; SparkSession<a href="#install-pyspark-modules--sparksession" class="hash-link" aria-label="Direct link to Install PySpark, Modules &amp; SparkSession" title="Direct link to Install PySpark, Modules &amp; SparkSession">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install pyspark</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># importing spark session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.sql import SparkSession</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># data visualization modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import plotly.express as px</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import plotly.colors as pc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pandas module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pyspark SQL functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.sql.functions import col, when, count, udf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pyspark data preprocessing modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.ml.feature import Imputer, StringIndexer, VectorAssembler, StandardScaler, OneHotEncoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pyspark data modeling and model evaluation modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.ml.classification import DecisionTreeClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.ml.evaluation import BinaryClassificationEvaluator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spark = SparkSession.builder.appName(&quot;Customer_Churn_Prediction&quot;).getOrCreate()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spark</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SparkSession - in-memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SparkContext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spark UI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v3.5.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local[*]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AppName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Customer_Churn_Prediction</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-dataset">Load Dataset<a href="#load-dataset" class="hash-link" aria-label="Direct link to Load Dataset" title="Direct link to Load Dataset">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">file_path = &quot;[YOUR PATH]/WA_Fn-UseC_-Telco-Customer-Churn.csv&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = spark.read.format(&#x27;csv&#x27;) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .option(&quot;inferSchema&quot;, True) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .option(&quot;header&quot;, True) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .load(file_path)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.show(4)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+--------------------+--------------+------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|gender|SeniorCitizen|Partner|Dependents|tenure|PhoneService|   MultipleLines|InternetService|OnlineSecurity|OnlineBackup|DeviceProtection|TechSupport|StreamingTV|StreamingMovies|      Contract|PaperlessBilling|       PaymentMethod|MonthlyCharges|TotalCharges|Churn|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+--------------------+--------------+------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7590-VHVEG|Female|            0|    Yes|        No|     1|          No|No phone service|            DSL|            No|         Yes|              No|         No|         No|             No|Month-to-month|             Yes|    Electronic check|         29.85|       29.85|   No|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|5575-GNVDE|  Male|            0|     No|        No|    34|         Yes|              No|            DSL|           Yes|          No|             Yes|         No|         No|             No|      One year|              No|        Mailed check|         56.95|      1889.5|   No|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|3668-QPYBK|  Male|            0|     No|        No|     2|         Yes|              No|            DSL|           Yes|         Yes|              No|         No|         No|             No|Month-to-month|             Yes|        Mailed check|         53.85|      108.15|  Yes|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7795-CFOCW|  Male|            0|     No|        No|    45|          No|No phone service|            DSL|           Yes|          No|             Yes|        Yes|         No|             No|      One year|              No|Bank transfer (au...|          42.3|     1840.75|   No|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+--------------------+--------------+------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 4 rows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="print-the-data-schema-to-check-out-the-data-types">Print the data schema to check out the data types<a href="#print-the-data-schema-to-check-out-the-data-types" class="hash-link" aria-label="Direct link to Print the data schema to check out the data types" title="Direct link to Print the data schema to check out the data types">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data.printSchema()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- customerID: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- SeniorCitizen: integer (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- Partner: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- Dependents: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- tenure: integer (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- PhoneService: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- MultipleLines: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- InternetService: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- OnlineSecurity: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- OnlineBackup: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- DeviceProtection: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- TechSupport: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- StreamingTV: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- StreamingMovies: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- Contract: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- PaperlessBilling: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- PaymentMethod: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- MonthlyCharges: double (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- TotalCharges: string (nullable = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |-- Churn: string (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.sql.functions import col</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = data.withColumn(&quot;TotalCharges&quot;, col(&quot;TotalCharges&quot;).cast(&quot;double&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.count()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">7043</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">len(data.columns)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">21</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exploratory-data-analysis">Exploratory Data Analysis<a href="#exploratory-data-analysis" class="hash-link" aria-label="Direct link to Exploratory Data Analysis" title="Direct link to Exploratory Data Analysis">​</a></h3>
<ul>
<li>Distribution Analysis</li>
<li>Correlation Analysis</li>
<li>Univariate Analysis</li>
<li>Finding Missing values</li>
</ul>
</li>
</ul>
<br>
<ul>
<li>
<p>Define lists to store different column names with different data types</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data.dtypes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[(&#x27;customerID&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;gender&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;SeniorCitizen&#x27;, &#x27;int&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;Partner&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;Dependents&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;tenure&#x27;, &#x27;int&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;PhoneService&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;MultipleLines&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;InternetService&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;OnlineSecurity&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;OnlineBackup&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;DeviceProtection&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;TechSupport&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;StreamingTV&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;StreamingMovies&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;Contract&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;PaperlessBilling&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;PaymentMethod&#x27;, &#x27;string&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;MonthlyCharges&#x27;, &#x27;double&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;TotalCharges&#x27;, &#x27;double&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (&#x27;Churn&#x27;, &#x27;string&#x27;)]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Numerical features and store them into a pandas dataframe.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">numerical_col = [name for name,typ in data.dtypes if typ==&quot;double&quot; or typ==&quot;int&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_col = [name for name,typ in data.dtypes if typ==&quot;string&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numerical_col</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;SeniorCitizen&#x27;, &#x27;tenure&#x27;, &#x27;MonthlyCharges&#x27;, &#x27;TotalCharges&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df = data.select(numerical_col).toPandas()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SeniorCitizen 	tenure 	MonthlyCharges 	TotalCharges</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 	0 	1 	29.85 	29.85</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 	0 	34 	56.95 	1889.50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 	0 	2 	53.85 	108.15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 	0 	45 	42.30 	1840.75</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4 	0 	2 	70.70 	151.65</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create histograms to analyse the distribution of our numerical columns.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fig = plt.figure(figsize=(15,10))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ax = fig.gca()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df.hist(ax=ax, bins = 20)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">array([[&lt;Axes: title={&#x27;center&#x27;: &#x27;SeniorCitizen&#x27;}&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;Axes: title={&#x27;center&#x27;: &#x27;tenure&#x27;}&gt;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [&lt;Axes: title={&#x27;center&#x27;: &#x27;MonthlyCharges&#x27;}&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;Axes: title={&#x27;center&#x27;: &#x27;TotalCharges&#x27;}&gt;]], dtype=object)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="/img/ai/machine-learning/customer-churn-prediction/01-cells-03.png" alt="01-cells-03.png">
</li>
<li>
<p>Generate the correlation matrix</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.corr()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SeniorCitizen 	tenure 	MonthlyCharges 	TotalCharges</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SeniorCitizen 	1.000000 	0.016567 	0.220173 	0.102411</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tenure 	0.016567 	1.000000 	0.247900 	0.825880</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MonthlyCharges 	0.220173 	0.247900 	1.000000 	0.651065</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TotalCharges 	0.102411 	0.825880 	0.651065 	1.000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Check the unique value count per each categorical variables</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data.groupby(&quot;contract&quot;).count().show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data.groupby(&quot;contract&quot;).count().show()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      contract|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Month-to-month| 3875|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      One year| 1473|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      Two year| 1695|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+-----+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for coll in categorical_col:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data.groupby(coll).count().show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|3668-QPYBK|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|6234-RAAPL|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|1894-IGFSG|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|6982-SSHFK|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|5859-HZYLF|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|6479-OAUSD|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|2592-YKDIF|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|6718-BDGHG|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|3195-TQDZX|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|4248-QPAVC|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|5668-MEISB|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|5802-ADBRC|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|2712-SYWAY|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|2011-TRQYE|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7244-KXYZN|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|0953-LGOVU|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|3623-FQBOX|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|3692-JHONH|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|3528-HFRIQ|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7661-CPURM|    1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 20 rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|gender|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Female| 3488|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  Male| 3555|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Partner|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     No| 3641|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    Yes| 3402|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Dependents|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|        No| 4933|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       Yes| 2110|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|PhoneService|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|          No|  682|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         Yes| 6361|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   MultipleLines|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No phone service|  682|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|              No| 3390|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             Yes| 2971|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|InternetService|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    Fiber optic| 3096|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             No| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|            DSL| 2421|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     OnlineSecurity|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 No| 3498|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                Yes| 2019|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No internet service| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       OnlineBackup|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 No| 3088|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                Yes| 2429|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No internet service| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   DeviceProtection|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 No| 3095|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                Yes| 2422|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No internet service| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|        TechSupport|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 No| 3473|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                Yes| 2044|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No internet service| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|        StreamingTV|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 No| 2810|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                Yes| 2707|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No internet service| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    StreamingMovies|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 No| 2785|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                Yes| 2732|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|No internet service| 1526|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      Contract|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Month-to-month| 3875|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      One year| 1473|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      Two year| 1695|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|PaperlessBilling|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|              No| 2872|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             Yes| 4171|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       PaymentMethod|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Credit card (auto...| 1522|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|        Mailed check| 1612|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Bank transfer (au...| 1544|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    Electronic check| 2365|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Churn|count|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   No| 5174|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  Yes| 1869|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+-----+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Find number of null values in all of our dataframe columns</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for coll in data.columns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data.select(count(when(col(coll).isNull(), coll)).alias(coll)).show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|gender|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|SeniorCitizen|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|            0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Partner|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Dependents|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|tenure|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|PhoneService|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|           0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|MultipleLines|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|            0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|InternetService|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|              0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|OnlineSecurity|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|OnlineBackup|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|           0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|DeviceProtection|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|               0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|TechSupport|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|          0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|StreamingTV|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|          0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|StreamingMovies|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|              0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Contract|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|PaperlessBilling|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|               0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|PaymentMethod|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|            0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|MonthlyCharges|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|TotalCharges|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|          11|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Churn|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-preprocessing">Data Preprocessing<a href="#data-preprocessing" class="hash-link" aria-label="Direct link to Data Preprocessing" title="Direct link to Data Preprocessing">​</a></h3>
<ul>
<li>
<p>Handling the missing values</p>
</li>
<li>
<p>Removing the outliers if they exist.</p>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="handling-the-missing-values">Handling the missing values<a href="#handling-the-missing-values" class="hash-link" aria-label="Direct link to Handling the missing values" title="Direct link to Handling the missing values">​</a></h4>
<ul>
<li>Create a list of column names with missing values</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">col_with_missing_val = [&quot;TotalCharges&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Creating our Imputer</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imputer = Imputer(inputCols=col_with_missing_val, outputCols=col_with_missing_val).setStrategy(&quot;mean&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Use Imputer to fill the missing values</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imputer_model = imputer.fit(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = imputer_model.transform(data)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removing-the-outliers">Removing the outliers<a href="#removing-the-outliers" class="hash-link" aria-label="Direct link to Removing the outliers" title="Direct link to Removing the outliers">​</a></h4>
<p>We should look at the histograms carefully to find any specific outlier out of the normal range. In this case we do not have any.</p>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="feature-preparation">Feature Preparation<a href="#feature-preparation" class="hash-link" aria-label="Direct link to Feature Preparation" title="Direct link to Feature Preparation">​</a></h4>
<p>1- Numerical Features:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1-1 Vector Assembling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1-2 Numerical Scaling</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2- Categorical Features:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2-1 String Indexing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2-2 Vector Assembling</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3- Combining the numerical and categorical feature vectors</p>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="vector-assembling">Vector Assembling<a href="#vector-assembling" class="hash-link" aria-label="Direct link to Vector Assembling" title="Direct link to Vector Assembling">​</a></h4>
<p>To apply our machine learning model we need to combine all of our numerical and categorical features into vectors. For now let&#x27;s create a feature vector for our numerical columns.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">numerical_vector_assembler = VectorAssembler(inputCols= numerical_col, outputCol= &quot;numerical_features_vector&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = numerical_vector_assembler.transform(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.show(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|gender|SeniorCitizen|Partner|Dependents|tenure|PhoneService|   MultipleLines|InternetService|OnlineSecurity|OnlineBackup|DeviceProtection|TechSupport|StreamingTV|StreamingMovies|      Contract|PaperlessBilling|   PaymentMethod|MonthlyCharges|TotalCharges|Churn|numerical_features_vector|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7590-VHVEG|Female|            0|    Yes|        No|     1|          No|No phone service|            DSL|            No|         Yes|              No|         No|         No|             No|Month-to-month|             Yes|Electronic check|         29.85|       29.85|   No|     [0.0,1.0,29.85,29...|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 1 row</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="numerical-scaling">Numerical Scaling<a href="#numerical-scaling" class="hash-link" aria-label="Direct link to Numerical Scaling" title="Direct link to Numerical Scaling">​</a></h4>
<p>Standardize all of our numerical features.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scaler = StandardScaler(inputCol=&quot;numerical_features_vector&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        outputCol= &quot;numerical_features_scaled&quot;, withStd = True, withMean=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = scaler.fit(data).transform(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.show(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|gender|SeniorCitizen|Partner|Dependents|tenure|PhoneService|   MultipleLines|InternetService|OnlineSecurity|OnlineBackup|DeviceProtection|TechSupport|StreamingTV|StreamingMovies|      Contract|PaperlessBilling|   PaymentMethod|MonthlyCharges|TotalCharges|Churn|numerical_features_vector|numerical_features_scaled|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7590-VHVEG|Female|            0|    Yes|        No|     1|          No|No phone service|            DSL|            No|         Yes|              No|         No|         No|             No|Month-to-month|             Yes|Electronic check|         29.85|       29.85|   No|     [0.0,1.0,29.85,29...|     [-0.4398852612617...|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 1 row</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="string-indexing">String Indexing<a href="#string-indexing" class="hash-link" aria-label="Direct link to String Indexing" title="Direct link to String Indexing">​</a></h4>
<p>We need to convert all the string columns to numeric columns. To do so, first let&#x27;s create a copy of each column.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">categorical_col_index = [name+&quot;_idx&quot; for name in categorical_col]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_col_index</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;customerID_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;gender_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;Partner_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;Dependents_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;PhoneService_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;MultipleLines_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;InternetService_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;OnlineSecurity_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;OnlineBackup_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;DeviceProtection_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;TechSupport_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;StreamingTV_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;StreamingMovies_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;Contract_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;PaperlessBilling_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;PaymentMethod_idx&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;Churn_idx&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">indexer = StringIndexer(inputCols=categorical_col, outputCols=categorical_col_index)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = indexer.fit(data).transform(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.show(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+--------------+----------+-----------+--------------+----------------+-----------------+-------------------+------------------+----------------+--------------------+---------------+---------------+-------------------+------------+--------------------+-----------------+---------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|gender|SeniorCitizen|Partner|Dependents|tenure|PhoneService|   MultipleLines|InternetService|OnlineSecurity|OnlineBackup|DeviceProtection|TechSupport|StreamingTV|StreamingMovies|      Contract|PaperlessBilling|   PaymentMethod|MonthlyCharges|TotalCharges|Churn|numerical_features_vector|numerical_features_scaled|customerID_idx|gender_idx|Partner_idx|Dependents_idx|PhoneService_idx|MultipleLines_idx|InternetService_idx|OnlineSecurity_idx|OnlineBackup_idx|DeviceProtection_idx|TechSupport_idx|StreamingTV_idx|StreamingMovies_idx|Contract_idx|PaperlessBilling_idx|PaymentMethod_idx|Churn_idx|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+--------------+----------+-----------+--------------+----------------+-----------------+-------------------+------------------+----------------+--------------------+---------------+---------------+-------------------+------------+--------------------+-----------------+---------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7590-VHVEG|Female|            0|    Yes|        No|     1|          No|No phone service|            DSL|            No|         Yes|              No|         No|         No|             No|Month-to-month|             Yes|Electronic check|         29.85|       29.85|   No|     [0.0,1.0,29.85,29...|     [-0.4398852612617...|        5375.0|       1.0|        1.0|           0.0|             1.0|              2.0|                1.0|               0.0|             1.0|                 0.0|            0.0|            0.0|                0.0|         0.0|                 0.0|              0.0|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+--------------+----------+-----------+--------------+----------------+-----------------+-------------------+------------------+----------------+--------------------+---------------+---------------+-------------------+------------+--------------------+-----------------+---------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 1 row</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="drop-extra">Drop extra<a href="#drop-extra" class="hash-link" aria-label="Direct link to Drop extra" title="Direct link to Drop extra">​</a></h4>
<p>customerID_idx won&#x27;t add any helpful information to us; let&#x27;s drop it. Churn_idx is the goal and should not be in the training process.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">categorical_col_index.remove(&quot;customerID_idx&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">categorical_col_index.remove(&quot;Churn_idx&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">categorical_vector_assembler = VectorAssembler(inputCols=categorical_col_index, outputCol=&quot;categorical_features&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = categorical_vector_assembler.transform(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.show(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+--------------+----------+-----------+--------------+----------------+-----------------+-------------------+------------------+----------------+--------------------+---------------+---------------+-------------------+------------+--------------------+-----------------+---------+--------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|customerID|gender|SeniorCitizen|Partner|Dependents|tenure|PhoneService|   MultipleLines|InternetService|OnlineSecurity|OnlineBackup|DeviceProtection|TechSupport|StreamingTV|StreamingMovies|      Contract|PaperlessBilling|   PaymentMethod|MonthlyCharges|TotalCharges|Churn|numerical_features_vector|numerical_features_scaled|customerID_idx|gender_idx|Partner_idx|Dependents_idx|PhoneService_idx|MultipleLines_idx|InternetService_idx|OnlineSecurity_idx|OnlineBackup_idx|DeviceProtection_idx|TechSupport_idx|StreamingTV_idx|StreamingMovies_idx|Contract_idx|PaperlessBilling_idx|PaymentMethod_idx|Churn_idx|categorical_features|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+--------------+----------+-----------+--------------+----------------+-----------------+-------------------+------------------+----------------+--------------------+---------------+---------------+-------------------+------------+--------------------+-----------------+---------+--------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|7590-VHVEG|Female|            0|    Yes|        No|     1|          No|No phone service|            DSL|            No|         Yes|              No|         No|         No|             No|Month-to-month|             Yes|Electronic check|         29.85|       29.85|   No|     [0.0,1.0,29.85,29...|     [-0.4398852612617...|        5375.0|       1.0|        1.0|           0.0|             1.0|              2.0|                1.0|               0.0|             1.0|                 0.0|            0.0|            0.0|                0.0|         0.0|                 0.0|              0.0|      0.0|(15,[0,1,3,4,5,7]...|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+------+-------------+-------+----------+------+------------+----------------+---------------+--------------+------------+----------------+-----------+-----------+---------------+--------------+----------------+----------------+--------------+------------+-----+-------------------------+-------------------------+--------------+----------+-----------+--------------+----------------+-----------------+-------------------+------------------+----------------+--------------------+---------------+---------------+-------------------+------------+--------------------+-----------------+---------+--------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 1 row</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="combining-features">Combining features<a href="#combining-features" class="hash-link" aria-label="Direct link to Combining features" title="Direct link to Combining features">​</a></h4>
<p>Now it is time to combine all of our categorifal features into one feature vector.</p>
<ul>
<li>Now let&#x27;s combine categorical and numerical feature vectors.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final_vector_assembler = VectorAssembler(inputCols=[&quot;categorical_features&quot;,&quot;numerical_features_scaled&quot;], outputCol=&quot;final_features&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = final_vector_assembler.transform(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.select([&quot;final_features&quot;,&quot;Churn_idx&quot;]).show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------+---------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      final_features|Churn_idx|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------+---------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[0,1,3,4,5,7,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[5,6,8,12,13,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[5,6,7,14,15,...|      1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[0.0,0.0,0.0,1.0,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[0,15,16,17,1...|      1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[0,4,8,10,11,...|      1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[2,4,7,10,14,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[0,3,4,5,6,13...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[0,1,4,8,9,10...|      1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[2,5,6,7,12,1...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[1,2,5,6,14,1...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[0.0,0.0,0.0,0.0,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[0.0,1.0,0.0,0.0,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[4,7,8,10,11,...|      1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[6,8,9,10,11,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[1.0,1.0,1.0,0.0,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[1.0,0.0,0.0,0.0,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[0.0,0.0,1.0,0.0,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|[1.0,1.0,1.0,0.0,...|      1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|(19,[0,7,8,11,15,...|      0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------+---------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 20 rows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="model-training">Model Training<a href="#model-training" class="hash-link" aria-label="Direct link to Model Training" title="Direct link to Model Training">​</a></h3>
<ul>
<li>Train and Test data splitting</li>
<li>Creating our model</li>
<li>Training our model</li>
<li>Make initial predictions using our model</li>
</ul>
<p>In this task, we are going to start training our model</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">train, test = data.randomSplit([0.7, 0.3], seed = 100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(train.count())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(test.count())</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">4931</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2112</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now let&#x27;s create and train our desicion tree</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dt = DecisionTreeClassifier(featuresCol=&quot;final_features&quot;, labelCol=&quot;Churn_idx&quot;, maxDepth=3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model = dt.fit(train)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">prediction_test = model.transform(test)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prediction_test.select([&quot;Churn_idx&quot;, &quot;prediction&quot;]).show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+---------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Churn_idx|prediction|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1.0|       1.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      0.0|       0.0|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 20 rows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="model-evaluation">Model Evaluation<a href="#model-evaluation" class="hash-link" aria-label="Direct link to Model Evaluation" title="Direct link to Model Evaluation">​</a></h3>
<ul>
<li>Calculating area under the ROC curve for the test set</li>
<li>Calculating area under the ROC curve for the training set</li>
<li>Hyper parameter tuning</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">evaluator = BinaryClassificationEvaluator(labelCol=&quot;Churn_idx&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auc_test = evaluator.evaluate(prediction_test, {evaluator.metricName: &quot;areaUnderROC&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auc_test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0.7617045633750168</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s get the AUC for our training set</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">prediction_train = model.transform(train)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">evaluator = BinaryClassificationEvaluator(labelCol=&quot;Churn_idx&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auc_train = evaluator.evaluate(prediction_train, {evaluator.metricName: &quot;areaUnderROC&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auc_train</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0.7712918493814211</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hyper-parameter-tuning">Hyper parameter tuning<a href="#hyper-parameter-tuning" class="hash-link" aria-label="Direct link to Hyper parameter tuning" title="Direct link to Hyper parameter tuning">​</a></h3>
<p>Let&#x27;s find the best maxDepth parameter for our DT model.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">def evaluate_dt(mode_params):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      test_accuracies = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      train_accuracies = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      for maxD in mode_params:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # train the model based on the maxD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        decision_tree = DecisionTreeClassifier(featuresCol = &#x27;final_features&#x27;, labelCol = &#x27;Churn_idx&#x27;, maxDepth = maxD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dtModel = decision_tree.fit(train)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # calculating test error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        predictions_test = dtModel.transform(test)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        evaluator = BinaryClassificationEvaluator(labelCol=&quot;Churn_idx&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auc_test = evaluator.evaluate(predictions_test, {evaluator.metricName: &quot;areaUnderROC&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # recording the accuracy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        test_accuracies.append(auc_test)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # calculating training error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        predictions_training = dtModel.transform(train)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        evaluator = BinaryClassificationEvaluator(labelCol=&quot;Churn_idx&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auc_training = evaluator.evaluate(predictions_training, {evaluator.metricName: &quot;areaUnderROC&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        train_accuracies.append(auc_training)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return(test_accuracies, train_accuracies)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s define params list to evaluate our model iteratively with differe maxDepth parameter.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">maxDepths = [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test_acc, train_acc = evaluate_dt(maxDepths)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(train_acc)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(test_acc)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Output:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[0.7789865142153861, 0.7712918493814211, 0.6826591069812441, 0.5698050008614369, 0.7097267756814049, 0.8007120163953875, 0.7888573028682286, 0.7956189539598643, 0.8211433720288286, 0.861543087146816, 0.8869290674809027, 0.9051710947878245, 0.9438019298702311, 0.9689805155962002, 0.9801039509144436, 0.9866789573385414, 0.9904768252507075, 0.9909386686251257, 0.991859001848212]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[0.7788716846464305, 0.7617045633750168, 0.6707372773945599, 0.5568304606596539, 0.6941230411597387, 0.7787209933941159, 0.754992377826191, 0.7483023871129775, 0.7435083026207427, 0.7541466377744421, 0.734785732225149, 0.7140236316591807, 0.7244768151579045, 0.7129863151316211, 0.7097137450280647, 0.7071496574402345, 0.7040645752901391, 0.7030885865978237, 0.7027474870189415]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s visualize our results</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ddf = pd.DataFrame()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddf[&quot;maxDepth&quot;] = maxDepths</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddf[&quot;trainAcc&quot;] = train_acc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddf[&quot;testAcc&quot;] = test_acc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddf.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">maxDepth 	trainAcc 	testAcc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 	2 	0.778987 	0.778872</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 	3 	0.771292 	0.761705</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 	4 	0.682659 	0.670737</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 	5 	0.569805 	0.556830</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4 	6 	0.709727 	0.694123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">my_palette = pc.qualitative.Bold</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">px.line(ddf, x = &quot;maxDepth&quot;, y = [&quot;trainAcc&quot;, &quot;testAcc&quot;], color_discrete_sequence=my_palette)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="/img/ai/machine-learning/customer-churn-prediction/01-cells-04.png" alt="01-cells-04.png">
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dt = DecisionTreeClassifier(featuresCol=&quot;final_features&quot;, labelCol=&quot;Churn_idx&quot;, maxDepth=7)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model = dt.fit(train)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recommendation">Recommendation<a href="#recommendation" class="hash-link" aria-label="Direct link to Recommendation" title="Direct link to Recommendation">​</a></h3>
<p>We were asked to recommend a solution to reduce the customer churn.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">feature_importance = model.featureImportances</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores = [score for i, score in enumerate(feature_importance)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ff = pd.DataFrame(scores, columns=[&quot;score&quot;], index = categorical_col_index + numerical_col)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">px.bar(ff, y = &quot;score&quot;, color_discrete_sequence=my_palette)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="/img/ai/machine-learning/customer-churn-prediction/01-cells-05.png" alt="01-cells-05.png">
</li>
</ul>
<p>🔍 Feature Importance Interpretation This chart shows which features had the biggest impact on our model’s predictions.</p>
<p>📌 Contract type is by far the most important factor in predicting churn. It contributes the most to the model’s decisions.</p>
<p>🧓 Tenure (how long the customer has been with the company) is also a major influence. Longer tenure usually means more loyalty.</p>
<p>🌐 Internet service type and whether the customer is a senior citizen also played notable roles.</p>
<p>In short, how long a customer stays and the kind of contract they have are key drivers of churn in this dataset.</p>
<p><br><strong>Let&#x27;s go deeper and create a bar chart to visualize the customer churn per contract type.</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df = data.groupby([&quot;Contract&quot;, &quot;Churn&quot;]).count().toPandas()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">px.bar(df, x = &quot;Contract&quot;, y = &quot;count&quot;, color = &quot;Churn&quot;, color_discrete_sequence=my_palette)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="/img/ai/machine-learning/customer-churn-prediction/01-cells-06.png" alt="01-cells-06.png">
<p>The chart shows how customer churn varies across different contract types. It’s clear that most of the churn comes from users on month-to-month contracts, while those on one-year or two-year plans are more likely to stay. To reduce churn, the company could offer special deals or perks that motivate month-to-month users to upgrade to longer-term commitments.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/artificial-intelligence/machine-learning/examples/customer-churn/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Customer Churn</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/artificial-intelligence/machine-learning/examples/stock-price-prediction/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stock Price Prediction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#description" class="table-of-contents__link toc-highlight">Description</a></li><li><a href="#code-of-the-example" class="table-of-contents__link toc-highlight">Code of the Example</a></li><li><a href="#jupyter-notebook" class="table-of-contents__link toc-highlight">Jupyter Notebook</a><ul><li><a href="#install-pyspark-modules--sparksession" class="table-of-contents__link toc-highlight">Install PySpark, Modules &amp; SparkSession</a></li><li><a href="#load-dataset" class="table-of-contents__link toc-highlight">Load Dataset</a></li><li><a href="#print-the-data-schema-to-check-out-the-data-types" class="table-of-contents__link toc-highlight">Print the data schema to check out the data types</a></li><li><a href="#exploratory-data-analysis" class="table-of-contents__link toc-highlight">Exploratory Data Analysis</a></li><li><a href="#data-preprocessing" class="table-of-contents__link toc-highlight">Data Preprocessing</a></li><li><a href="#model-training" class="table-of-contents__link toc-highlight">Model Training</a></li><li><a href="#model-evaluation" class="table-of-contents__link toc-highlight">Model Evaluation</a></li><li><a href="#hyper-parameter-tuning" class="table-of-contents__link toc-highlight">Hyper parameter tuning</a></li><li><a href="#recommendation" class="table-of-contents__link toc-highlight">Recommendation</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://netty.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Netty Project<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/reactive-streams/reactive-streams-jvm?tab=readme-ov-file" target="_blank" rel="noopener noreferrer" class="footer__link-item">reactive-streams-jvm <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://pages.github.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Pages<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">License</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-sa.png" alt="CC BY-SA License" height="40px" width="114px"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 jreact.com</div></div></div></footer></div>
</body>
</html>